using System;
using System.Collections.Generic;
using TaleWorlds.Library;
using TaleWorlds.ObjectSystem;
using TaleWorlds.SaveSystem;

namespace TaleWorlds.Core
{
	// Token: 0x0200003E RID: 62
	public struct ItemRosterElement : ISerializableObject
	{
		// Token: 0x060004C5 RID: 1221 RVA: 0x000121E4 File Offset: 0x000103E4
		public static void AutoGeneratedStaticCollectObjectsItemRosterElement(object o, List<object> collectedObjects)
		{
			((ItemRosterElement)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x060004C6 RID: 1222 RVA: 0x00012200 File Offset: 0x00010400
		private void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			EquipmentElement.AutoGeneratedStaticCollectObjectsEquipmentElement(this.EquipmentElement, collectedObjects);
		}

		// Token: 0x060004C7 RID: 1223 RVA: 0x00012214 File Offset: 0x00010414
		internal static object AutoGeneratedGetMemberValueEquipmentElement(object o)
		{
			return ((ItemRosterElement)o).EquipmentElement;
		}

		// Token: 0x060004C8 RID: 1224 RVA: 0x00012234 File Offset: 0x00010434
		internal static object AutoGeneratedGetMemberValue_amount(object o)
		{
			return ((ItemRosterElement)o)._amount;
		}

		// Token: 0x1700019A RID: 410
		// (get) Token: 0x060004C9 RID: 1225 RVA: 0x00012246 File Offset: 0x00010446
		public static ItemRosterElement Invalid
		{
			get
			{
				return ItemRosterElement.StaticInvalidElement;
			}
		}

		// Token: 0x1700019B RID: 411
		// (get) Token: 0x060004CA RID: 1226 RVA: 0x0001224D File Offset: 0x0001044D
		// (set) Token: 0x060004CB RID: 1227 RVA: 0x00012255 File Offset: 0x00010455
		[SaveableProperty(21)]
		public EquipmentElement EquipmentElement { get; private set; }

		// Token: 0x1700019C RID: 412
		// (get) Token: 0x060004CC RID: 1228 RVA: 0x0001225E File Offset: 0x0001045E
		// (set) Token: 0x060004CD RID: 1229 RVA: 0x00012266 File Offset: 0x00010466
		public int Amount
		{
			get
			{
				return this._amount;
			}
			set
			{
				if (value < 0)
				{
					throw new MBUnderFlowException("ItemRosterElement::Amount");
				}
				this._amount = value;
			}
		}

		// Token: 0x1700019D RID: 413
		// (get) Token: 0x060004CE RID: 1230 RVA: 0x00012280 File Offset: 0x00010480
		public bool IsEmpty
		{
			get
			{
				return this.EquipmentElement.Item == null;
			}
		}

		// Token: 0x060004CF RID: 1231 RVA: 0x0001229E File Offset: 0x0001049E
		public ItemRosterElement(ItemObject item, int amount = 0, ItemModifier itemModifier = null)
		{
			this = default(ItemRosterElement);
			this.EquipmentElement = new EquipmentElement(item, itemModifier, null, false);
			this._amount = amount;
		}

		// Token: 0x060004D0 RID: 1232 RVA: 0x000122BD File Offset: 0x000104BD
		public ItemRosterElement(EquipmentElement equipmentElement, int amount)
		{
			this.EquipmentElement = equipmentElement;
			this._amount = amount;
		}

		// Token: 0x060004D1 RID: 1233 RVA: 0x000122D0 File Offset: 0x000104D0
		public override int GetHashCode()
		{
			return this.EquipmentElement.GetHashCode();
		}

		// Token: 0x060004D2 RID: 1234 RVA: 0x000122F4 File Offset: 0x000104F4
		public override string ToString()
		{
			return this.EquipmentElement.Item.ToString() + " x" + this.Amount.ToString();
		}

		// Token: 0x060004D3 RID: 1235 RVA: 0x0001232C File Offset: 0x0001052C
		public ItemRosterElement(ItemRosterElement itemRosterElement)
		{
			this = new ItemRosterElement(itemRosterElement.EquipmentElement.Item, itemRosterElement.Amount, itemRosterElement.EquipmentElement.ItemModifier);
		}

		// Token: 0x060004D4 RID: 1236 RVA: 0x00012364 File Offset: 0x00010564
		public void Clear()
		{
			this.EquipmentElement.Clear();
			this.Amount = 0;
		}

		// Token: 0x060004D5 RID: 1237 RVA: 0x00012388 File Offset: 0x00010588
		public bool IsEqualTo(ItemRosterElement other)
		{
			return this.Amount == other.Amount && this.EquipmentElement.IsEqualTo(other.EquipmentElement);
		}

		// Token: 0x060004D6 RID: 1238 RVA: 0x000123BC File Offset: 0x000105BC
		public override bool Equals(object obj)
		{
			return this.EquipmentElement.Equals(obj);
		}

		// Token: 0x060004D7 RID: 1239 RVA: 0x000123E0 File Offset: 0x000105E0
		public bool Equals(ItemRosterElement other)
		{
			return this.EquipmentElement.Equals(other);
		}

		// Token: 0x060004D8 RID: 1240 RVA: 0x000123FC File Offset: 0x000105FC
		public float GetRosterElementWeight()
		{
			return this.EquipmentElement.GetEquipmentElementWeight() * (float)this.Amount;
		}

		// Token: 0x060004D9 RID: 1241 RVA: 0x00012420 File Offset: 0x00010620
		void ISerializableObject.DeserializeFrom(IReader reader)
		{
			this.Amount = reader.ReadInt();
			string text = reader.ReadString();
			ItemModifier itemModifier = null;
			if (text != "")
			{
				itemModifier = Game.Current.ObjectManager.GetObject<ItemModifier>(text);
			}
			MBGUID mbguid = new MBGUID(reader.ReadUInt());
			ItemObject itemObject = MBObjectManager.Instance.GetObject(mbguid) as ItemObject;
			this.EquipmentElement = new EquipmentElement(itemObject, itemModifier, null, false);
		}

		// Token: 0x060004DA RID: 1242 RVA: 0x00012490 File Offset: 0x00010690
		void ISerializableObject.SerializeTo(IWriter writer)
		{
			writer.WriteInt(this.Amount);
			writer.WriteString((this.EquipmentElement.ItemModifier != null) ? this.EquipmentElement.ItemModifier.StringId : "");
			ItemObject item = this.EquipmentElement.Item;
			writer.WriteUInt((item != null) ? item.Id.InternalValue : 0U);
		}

		// Token: 0x04000258 RID: 600
		private static readonly ItemRosterElement StaticInvalidElement = new ItemRosterElement(null, 0, null);

		// Token: 0x04000259 RID: 601
		[SaveableField(11)]
		private int _amount;
	}
}
