using System;
using System.Collections.Generic;
using TaleWorlds.SaveSystem;

namespace TaleWorlds.CampaignSystem.Conversation.Persuasion
{
	public class PersuasionAttempt
	{
		internal static void AutoGeneratedStaticCollectObjectsPersuasionAttempt(object o, List<object> collectedObjects)
		{
			((PersuasionAttempt)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		protected virtual void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			collectedObjects.Add(this.PersuadedHero);
			CampaignTime.AutoGeneratedStaticCollectObjectsCampaignTime(this.GameTime, collectedObjects);
			collectedObjects.Add(this.Args);
		}

		internal static object AutoGeneratedGetMemberValueReservationType(object o)
		{
			return ((PersuasionAttempt)o).ReservationType;
		}

		internal static object AutoGeneratedGetMemberValuePersuadedHero(object o)
		{
			return ((PersuasionAttempt)o).PersuadedHero;
		}

		internal static object AutoGeneratedGetMemberValueGameTime(object o)
		{
			return ((PersuasionAttempt)o).GameTime;
		}

		internal static object AutoGeneratedGetMemberValueArgs(object o)
		{
			return ((PersuasionAttempt)o).Args;
		}

		internal static object AutoGeneratedGetMemberValueResult(object o)
		{
			return ((PersuasionAttempt)o).Result;
		}

		public PersuasionAttempt(Hero persuadedHero, CampaignTime gameTime, PersuasionOptionArgs args, PersuasionOptionResult result, int reservationType)
		{
			this.PersuadedHero = persuadedHero;
			this.GameTime = gameTime;
			this.Args = args;
			this.Result = result;
			this.ReservationType = reservationType;
		}

		public bool IsSuccesful()
		{
			return this.Result == PersuasionOptionResult.Success || this.Result == PersuasionOptionResult.CriticalSuccess;
		}

		public bool Matches(Hero targetHero, int reservationType)
		{
			return this.PersuadedHero == targetHero && this.ReservationType == reservationType;
		}

		[SaveableField(2)]
		public readonly int ReservationType;

		[SaveableField(3)]
		public readonly Hero PersuadedHero;

		[SaveableField(4)]
		public readonly CampaignTime GameTime;

		[SaveableField(5)]
		public readonly PersuasionOptionArgs Args;

		[SaveableField(6)]
		public readonly PersuasionOptionResult Result;
	}
}
