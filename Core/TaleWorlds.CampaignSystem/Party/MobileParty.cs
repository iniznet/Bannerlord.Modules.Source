using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using Helpers;
using TaleWorlds.CampaignSystem.Actions;
using TaleWorlds.CampaignSystem.CharacterDevelopment;
using TaleWorlds.CampaignSystem.Encounters;
using TaleWorlds.CampaignSystem.GameMenus;
using TaleWorlds.CampaignSystem.GameState;
using TaleWorlds.CampaignSystem.Map;
using TaleWorlds.CampaignSystem.MapEvents;
using TaleWorlds.CampaignSystem.Party.PartyComponents;
using TaleWorlds.CampaignSystem.Roster;
using TaleWorlds.CampaignSystem.Settlements;
using TaleWorlds.CampaignSystem.Siege;
using TaleWorlds.Core;
using TaleWorlds.Library;
using TaleWorlds.Localization;
using TaleWorlds.SaveSystem;
using TaleWorlds.SaveSystem.Load;

namespace TaleWorlds.CampaignSystem.Party
{
	// Token: 0x0200029F RID: 671
	public sealed class MobileParty : CampaignObjectBase, ILocatable<MobileParty>, IMapPoint, ITrackableCampaignObject, ITrackableBase, IMapEntity, IRandomOwner
	{
		// Token: 0x06002421 RID: 9249 RVA: 0x0009958C File Offset: 0x0009778C
		internal static void AutoGeneratedStaticCollectObjectsMobileParty(object o, List<object> collectedObjects)
		{
			((MobileParty)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x06002422 RID: 9250 RVA: 0x0009959C File Offset: 0x0009779C
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
			collectedObjects.Add(this._currentSettlement);
			collectedObjects.Add(this._attachedTo);
			CampaignTime.AutoGeneratedStaticCollectObjectsCampaignTime(this._disorganizedUntilTime, collectedObjects);
			collectedObjects.Add(this._besiegerCamp);
			collectedObjects.Add(this._targetParty);
			collectedObjects.Add(this._targetSettlement);
			collectedObjects.Add(this._customHomeSettlement);
			collectedObjects.Add(this._army);
			CampaignTime.AutoGeneratedStaticCollectObjectsCampaignTime(this._ignoredUntilTime, collectedObjects);
			collectedObjects.Add(this._actualClan);
			collectedObjects.Add(this._partyComponent);
			collectedObjects.Add(this.CustomName);
			collectedObjects.Add(this.LastVisitedSettlement);
			collectedObjects.Add(this.Ai);
			collectedObjects.Add(this.Party);
			CampaignTime.AutoGeneratedStaticCollectObjectsCampaignTime(this.StationaryStartTime, collectedObjects);
			collectedObjects.Add(this.Scout);
			collectedObjects.Add(this.Engineer);
			collectedObjects.Add(this.Quartermaster);
			collectedObjects.Add(this.Surgeon);
		}

		// Token: 0x06002423 RID: 9251 RVA: 0x000996AF File Offset: 0x000978AF
		internal static object AutoGeneratedGetMemberValueCustomName(object o)
		{
			return ((MobileParty)o).CustomName;
		}

		// Token: 0x06002424 RID: 9252 RVA: 0x000996BC File Offset: 0x000978BC
		internal static object AutoGeneratedGetMemberValueLastVisitedSettlement(object o)
		{
			return ((MobileParty)o).LastVisitedSettlement;
		}

		// Token: 0x06002425 RID: 9253 RVA: 0x000996C9 File Offset: 0x000978C9
		internal static object AutoGeneratedGetMemberValueBearing(object o)
		{
			return ((MobileParty)o).Bearing;
		}

		// Token: 0x06002426 RID: 9254 RVA: 0x000996DB File Offset: 0x000978DB
		internal static object AutoGeneratedGetMemberValueAggressiveness(object o)
		{
			return ((MobileParty)o).Aggressiveness;
		}

		// Token: 0x06002427 RID: 9255 RVA: 0x000996ED File Offset: 0x000978ED
		internal static object AutoGeneratedGetMemberValueArmyPositionAdder(object o)
		{
			return ((MobileParty)o).ArmyPositionAdder;
		}

		// Token: 0x06002428 RID: 9256 RVA: 0x000996FF File Offset: 0x000978FF
		internal static object AutoGeneratedGetMemberValueObjective(object o)
		{
			return ((MobileParty)o).Objective;
		}

		// Token: 0x06002429 RID: 9257 RVA: 0x00099711 File Offset: 0x00097911
		internal static object AutoGeneratedGetMemberValueAi(object o)
		{
			return ((MobileParty)o).Ai;
		}

		// Token: 0x0600242A RID: 9258 RVA: 0x0009971E File Offset: 0x0009791E
		internal static object AutoGeneratedGetMemberValueParty(object o)
		{
			return ((MobileParty)o).Party;
		}

		// Token: 0x0600242B RID: 9259 RVA: 0x0009972B File Offset: 0x0009792B
		internal static object AutoGeneratedGetMemberValueIsActive(object o)
		{
			return ((MobileParty)o).IsActive;
		}

		// Token: 0x0600242C RID: 9260 RVA: 0x0009973D File Offset: 0x0009793D
		internal static object AutoGeneratedGetMemberValueShortTermBehavior(object o)
		{
			return ((MobileParty)o).ShortTermBehavior;
		}

		// Token: 0x0600242D RID: 9261 RVA: 0x0009974F File Offset: 0x0009794F
		internal static object AutoGeneratedGetMemberValueIsPartyTradeActive(object o)
		{
			return ((MobileParty)o).IsPartyTradeActive;
		}

		// Token: 0x0600242E RID: 9262 RVA: 0x00099761 File Offset: 0x00097961
		internal static object AutoGeneratedGetMemberValuePartyTradeTaxGold(object o)
		{
			return ((MobileParty)o).PartyTradeTaxGold;
		}

		// Token: 0x0600242F RID: 9263 RVA: 0x00099773 File Offset: 0x00097973
		internal static object AutoGeneratedGetMemberValueStationaryStartTime(object o)
		{
			return ((MobileParty)o).StationaryStartTime;
		}

		// Token: 0x06002430 RID: 9264 RVA: 0x00099785 File Offset: 0x00097985
		internal static object AutoGeneratedGetMemberValueShouldJoinPlayerBattles(object o)
		{
			return ((MobileParty)o).ShouldJoinPlayerBattles;
		}

		// Token: 0x06002431 RID: 9265 RVA: 0x00099797 File Offset: 0x00097997
		internal static object AutoGeneratedGetMemberValueIsDisbanding(object o)
		{
			return ((MobileParty)o).IsDisbanding;
		}

		// Token: 0x06002432 RID: 9266 RVA: 0x000997A9 File Offset: 0x000979A9
		internal static object AutoGeneratedGetMemberValueScout(object o)
		{
			return ((MobileParty)o).Scout;
		}

		// Token: 0x06002433 RID: 9267 RVA: 0x000997B6 File Offset: 0x000979B6
		internal static object AutoGeneratedGetMemberValueEngineer(object o)
		{
			return ((MobileParty)o).Engineer;
		}

		// Token: 0x06002434 RID: 9268 RVA: 0x000997C3 File Offset: 0x000979C3
		internal static object AutoGeneratedGetMemberValueQuartermaster(object o)
		{
			return ((MobileParty)o).Quartermaster;
		}

		// Token: 0x06002435 RID: 9269 RVA: 0x000997D0 File Offset: 0x000979D0
		internal static object AutoGeneratedGetMemberValueSurgeon(object o)
		{
			return ((MobileParty)o).Surgeon;
		}

		// Token: 0x06002436 RID: 9270 RVA: 0x000997DD File Offset: 0x000979DD
		internal static object AutoGeneratedGetMemberValueHasUnpaidWages(object o)
		{
			return ((MobileParty)o).HasUnpaidWages;
		}

		// Token: 0x06002437 RID: 9271 RVA: 0x000997EF File Offset: 0x000979EF
		internal static object AutoGeneratedGetMemberValueAverageFleeTargetDirection(object o)
		{
			return ((MobileParty)o).AverageFleeTargetDirection;
		}

		// Token: 0x06002438 RID: 9272 RVA: 0x00099801 File Offset: 0x00097A01
		internal static object AutoGeneratedGetMemberValue_currentSettlement(object o)
		{
			return ((MobileParty)o)._currentSettlement;
		}

		// Token: 0x06002439 RID: 9273 RVA: 0x0009980E File Offset: 0x00097A0E
		internal static object AutoGeneratedGetMemberValue_attachedTo(object o)
		{
			return ((MobileParty)o)._attachedTo;
		}

		// Token: 0x0600243A RID: 9274 RVA: 0x0009981B File Offset: 0x00097A1B
		internal static object AutoGeneratedGetMemberValue_eventPositionAdder(object o)
		{
			return ((MobileParty)o)._eventPositionAdder;
		}

		// Token: 0x0600243B RID: 9275 RVA: 0x0009982D File Offset: 0x00097A2D
		internal static object AutoGeneratedGetMemberValue_position2D(object o)
		{
			return ((MobileParty)o)._position2D;
		}

		// Token: 0x0600243C RID: 9276 RVA: 0x0009983F File Offset: 0x00097A3F
		internal static object AutoGeneratedGetMemberValue_isVisible(object o)
		{
			return ((MobileParty)o)._isVisible;
		}

		// Token: 0x0600243D RID: 9277 RVA: 0x00099851 File Offset: 0x00097A51
		internal static object AutoGeneratedGetMemberValue_isInspected(object o)
		{
			return ((MobileParty)o)._isInspected;
		}

		// Token: 0x0600243E RID: 9278 RVA: 0x00099863 File Offset: 0x00097A63
		internal static object AutoGeneratedGetMemberValue_disorganizedUntilTime(object o)
		{
			return ((MobileParty)o)._disorganizedUntilTime;
		}

		// Token: 0x0600243F RID: 9279 RVA: 0x00099875 File Offset: 0x00097A75
		internal static object AutoGeneratedGetMemberValue_besiegerCamp(object o)
		{
			return ((MobileParty)o)._besiegerCamp;
		}

		// Token: 0x06002440 RID: 9280 RVA: 0x00099882 File Offset: 0x00097A82
		internal static object AutoGeneratedGetMemberValue_targetParty(object o)
		{
			return ((MobileParty)o)._targetParty;
		}

		// Token: 0x06002441 RID: 9281 RVA: 0x0009988F File Offset: 0x00097A8F
		internal static object AutoGeneratedGetMemberValue_targetSettlement(object o)
		{
			return ((MobileParty)o)._targetSettlement;
		}

		// Token: 0x06002442 RID: 9282 RVA: 0x0009989C File Offset: 0x00097A9C
		internal static object AutoGeneratedGetMemberValue_targetPosition(object o)
		{
			return ((MobileParty)o)._targetPosition;
		}

		// Token: 0x06002443 RID: 9283 RVA: 0x000998AE File Offset: 0x00097AAE
		internal static object AutoGeneratedGetMemberValue_customHomeSettlement(object o)
		{
			return ((MobileParty)o)._customHomeSettlement;
		}

		// Token: 0x06002444 RID: 9284 RVA: 0x000998BB File Offset: 0x00097ABB
		internal static object AutoGeneratedGetMemberValue_army(object o)
		{
			return ((MobileParty)o)._army;
		}

		// Token: 0x06002445 RID: 9285 RVA: 0x000998C8 File Offset: 0x00097AC8
		internal static object AutoGeneratedGetMemberValue_isCurrentlyUsedByAQuest(object o)
		{
			return ((MobileParty)o)._isCurrentlyUsedByAQuest;
		}

		// Token: 0x06002446 RID: 9286 RVA: 0x000998DA File Offset: 0x00097ADA
		internal static object AutoGeneratedGetMemberValue_partyTradeGold(object o)
		{
			return ((MobileParty)o)._partyTradeGold;
		}

		// Token: 0x06002447 RID: 9287 RVA: 0x000998EC File Offset: 0x00097AEC
		internal static object AutoGeneratedGetMemberValue_ignoredUntilTime(object o)
		{
			return ((MobileParty)o)._ignoredUntilTime;
		}

		// Token: 0x06002448 RID: 9288 RVA: 0x000998FE File Offset: 0x00097AFE
		internal static object AutoGeneratedGetMemberValue_actualClan(object o)
		{
			return ((MobileParty)o)._actualClan;
		}

		// Token: 0x06002449 RID: 9289 RVA: 0x0009990B File Offset: 0x00097B0B
		internal static object AutoGeneratedGetMemberValue_moraleDueToEvents(object o)
		{
			return ((MobileParty)o)._moraleDueToEvents;
		}

		// Token: 0x0600244A RID: 9290 RVA: 0x0009991D File Offset: 0x00097B1D
		internal static object AutoGeneratedGetMemberValue_partyComponent(object o)
		{
			return ((MobileParty)o)._partyComponent;
		}

		// Token: 0x170008DD RID: 2269
		// (get) Token: 0x0600244B RID: 9291 RVA: 0x0009992A File Offset: 0x00097B2A
		public static MobileParty MainParty
		{
			get
			{
				return Campaign.Current.MainParty;
			}
		}

		// Token: 0x170008DE RID: 2270
		// (get) Token: 0x0600244C RID: 9292 RVA: 0x00099936 File Offset: 0x00097B36
		public static MBReadOnlyList<MobileParty> All
		{
			get
			{
				return Campaign.Current.MobileParties;
			}
		}

		// Token: 0x170008DF RID: 2271
		// (get) Token: 0x0600244D RID: 9293 RVA: 0x00099942 File Offset: 0x00097B42
		public static MBReadOnlyList<MobileParty> AllCaravanParties
		{
			get
			{
				return Campaign.Current.CaravanParties;
			}
		}

		// Token: 0x170008E0 RID: 2272
		// (get) Token: 0x0600244E RID: 9294 RVA: 0x0009994E File Offset: 0x00097B4E
		public static MBReadOnlyList<MobileParty> AllBanditParties
		{
			get
			{
				return Campaign.Current.BanditParties;
			}
		}

		// Token: 0x170008E1 RID: 2273
		// (get) Token: 0x0600244F RID: 9295 RVA: 0x0009995A File Offset: 0x00097B5A
		public static MBReadOnlyList<MobileParty> AllLordParties
		{
			get
			{
				return Campaign.Current.LordParties;
			}
		}

		// Token: 0x170008E2 RID: 2274
		// (get) Token: 0x06002450 RID: 9296 RVA: 0x00099966 File Offset: 0x00097B66
		public static MBReadOnlyList<MobileParty> AllGarrisonParties
		{
			get
			{
				return Campaign.Current.GarrisonParties;
			}
		}

		// Token: 0x170008E3 RID: 2275
		// (get) Token: 0x06002451 RID: 9297 RVA: 0x00099972 File Offset: 0x00097B72
		public static MBReadOnlyList<MobileParty> AllMilitiaParties
		{
			get
			{
				return Campaign.Current.MilitiaParties;
			}
		}

		// Token: 0x170008E4 RID: 2276
		// (get) Token: 0x06002452 RID: 9298 RVA: 0x0009997E File Offset: 0x00097B7E
		public static MBReadOnlyList<MobileParty> AllVillagerParties
		{
			get
			{
				return Campaign.Current.VillagerParties;
			}
		}

		// Token: 0x170008E5 RID: 2277
		// (get) Token: 0x06002453 RID: 9299 RVA: 0x0009998A File Offset: 0x00097B8A
		public static MBReadOnlyList<MobileParty> AllCustomParties
		{
			get
			{
				return Campaign.Current.CustomParties;
			}
		}

		// Token: 0x170008E6 RID: 2278
		// (get) Token: 0x06002454 RID: 9300 RVA: 0x00099996 File Offset: 0x00097B96
		public static MBReadOnlyList<MobileParty> AllPartiesWithoutPartyComponent
		{
			get
			{
				return Campaign.Current.PartiesWithoutPartyComponent;
			}
		}

		// Token: 0x170008E7 RID: 2279
		// (get) Token: 0x06002455 RID: 9301 RVA: 0x000999A2 File Offset: 0x00097BA2
		public static int Count
		{
			get
			{
				return Campaign.Current.MobileParties.Count;
			}
		}

		// Token: 0x170008E8 RID: 2280
		// (get) Token: 0x06002456 RID: 9302 RVA: 0x000999B3 File Offset: 0x00097BB3
		public static MobileParty ConversationParty
		{
			get
			{
				return Campaign.Current.ConversationManager.ConversationParty;
			}
		}

		// Token: 0x170008E9 RID: 2281
		// (get) Token: 0x06002457 RID: 9303 RVA: 0x000999C4 File Offset: 0x00097BC4
		// (set) Token: 0x06002458 RID: 9304 RVA: 0x000999CC File Offset: 0x00097BCC
		[SaveableProperty(1021)]
		private TextObject CustomName { get; set; }

		// Token: 0x170008EA RID: 2282
		// (get) Token: 0x06002459 RID: 9305 RVA: 0x000999D5 File Offset: 0x00097BD5
		public TextObject Name
		{
			get
			{
				if (!TextObject.IsNullOrEmpty(this.CustomName))
				{
					return this.CustomName;
				}
				if (this._partyComponent == null)
				{
					return new TextObject("{=!}unnamedMobileParty", null);
				}
				return this._partyComponent.Name;
			}
		}

		// Token: 0x170008EB RID: 2283
		// (get) Token: 0x0600245A RID: 9306 RVA: 0x00099A0A File Offset: 0x00097C0A
		// (set) Token: 0x0600245B RID: 9307 RVA: 0x00099A12 File Offset: 0x00097C12
		[SaveableProperty(1002)]
		public Settlement LastVisitedSettlement { get; private set; }

		// Token: 0x170008EC RID: 2284
		// (get) Token: 0x0600245C RID: 9308 RVA: 0x00099A1B File Offset: 0x00097C1B
		// (set) Token: 0x0600245D RID: 9309 RVA: 0x00099A23 File Offset: 0x00097C23
		[SaveableProperty(1004)]
		public Vec2 Bearing { get; internal set; }

		// Token: 0x170008ED RID: 2285
		// (get) Token: 0x0600245E RID: 9310 RVA: 0x00099A2C File Offset: 0x00097C2C
		public MBReadOnlyList<MobileParty> AttachedParties
		{
			get
			{
				return this._attachedParties;
			}
		}

		// Token: 0x170008EE RID: 2286
		// (get) Token: 0x0600245F RID: 9311 RVA: 0x00099A34 File Offset: 0x00097C34
		// (set) Token: 0x06002460 RID: 9312 RVA: 0x00099A3C File Offset: 0x00097C3C
		[SaveableProperty(1009)]
		public float Aggressiveness { get; set; }

		// Token: 0x170008EF RID: 2287
		// (get) Token: 0x06002461 RID: 9313 RVA: 0x00099A45 File Offset: 0x00097C45
		public int PaymentLimit
		{
			get
			{
				PartyComponent partyComponent = this._partyComponent;
				if (partyComponent == null)
				{
					return Campaign.Current.Models.PartyWageModel.MaxWage;
				}
				return partyComponent.WagePaymentLimit;
			}
		}

		// Token: 0x06002462 RID: 9314 RVA: 0x00099A6B File Offset: 0x00097C6B
		public bool HasLimitedWage()
		{
			return this.PaymentLimit != Campaign.Current.Models.PartyWageModel.MaxWage;
		}

		// Token: 0x06002463 RID: 9315 RVA: 0x00099A8C File Offset: 0x00097C8C
		public bool CanPayMoreWage()
		{
			return !this.HasLimitedWage() || this.PaymentLimit > this.TotalWage;
		}

		// Token: 0x06002464 RID: 9316 RVA: 0x00099AA6 File Offset: 0x00097CA6
		public bool IsWageLimitExceeded()
		{
			return this.HasLimitedWage() && this.PaymentLimit < this.TotalWage;
		}

		// Token: 0x06002465 RID: 9317 RVA: 0x00099AC0 File Offset: 0x00097CC0
		public void SetWagePaymentLimit(int newLimit)
		{
			PartyComponent partyComponent = this.PartyComponent;
			if (partyComponent == null)
			{
				return;
			}
			partyComponent.SetWagePaymentLimit(newLimit);
		}

		// Token: 0x170008F0 RID: 2288
		// (get) Token: 0x06002466 RID: 9318 RVA: 0x00099AD3 File Offset: 0x00097CD3
		// (set) Token: 0x06002467 RID: 9319 RVA: 0x00099ADB File Offset: 0x00097CDB
		[SaveableProperty(1005)]
		public Vec2 ArmyPositionAdder { get; private set; }

		// Token: 0x170008F1 RID: 2289
		// (get) Token: 0x06002468 RID: 9320 RVA: 0x00099AE4 File Offset: 0x00097CE4
		public Vec2 AiBehaviorTarget
		{
			get
			{
				return this.Ai.BehaviorTarget;
			}
		}

		// Token: 0x170008F2 RID: 2290
		// (get) Token: 0x06002469 RID: 9321 RVA: 0x00099AF1 File Offset: 0x00097CF1
		// (set) Token: 0x0600246A RID: 9322 RVA: 0x00099AF9 File Offset: 0x00097CF9
		[SaveableProperty(1090)]
		public MobileParty.PartyObjective Objective { get; private set; }

		// Token: 0x170008F3 RID: 2291
		// (get) Token: 0x0600246B RID: 9323 RVA: 0x00099B02 File Offset: 0x00097D02
		// (set) Token: 0x0600246C RID: 9324 RVA: 0x00099B0A File Offset: 0x00097D0A
		[CachedData]
		MobileParty ILocatable<MobileParty>.NextLocatable { get; set; }

		// Token: 0x170008F4 RID: 2292
		// (get) Token: 0x0600246D RID: 9325 RVA: 0x00099B13 File Offset: 0x00097D13
		// (set) Token: 0x0600246E RID: 9326 RVA: 0x00099B1B File Offset: 0x00097D1B
		[SaveableProperty(1019)]
		public MobilePartyAi Ai { get; private set; }

		// Token: 0x170008F5 RID: 2293
		// (get) Token: 0x0600246F RID: 9327 RVA: 0x00099B24 File Offset: 0x00097D24
		// (set) Token: 0x06002470 RID: 9328 RVA: 0x00099B2C File Offset: 0x00097D2C
		[SaveableProperty(1020)]
		public PartyBase Party { get; private set; }

		// Token: 0x170008F6 RID: 2294
		// (get) Token: 0x06002471 RID: 9329 RVA: 0x00099B35 File Offset: 0x00097D35
		// (set) Token: 0x06002472 RID: 9330 RVA: 0x00099B3D File Offset: 0x00097D3D
		[SaveableProperty(1023)]
		public bool IsActive { get; set; }

		// Token: 0x170008F7 RID: 2295
		// (get) Token: 0x06002473 RID: 9331 RVA: 0x00099B46 File Offset: 0x00097D46
		public CampaignTime DisorganizedUntilTime
		{
			get
			{
				return this._disorganizedUntilTime;
			}
		}

		// Token: 0x170008F8 RID: 2296
		// (get) Token: 0x06002474 RID: 9332 RVA: 0x00099B4E File Offset: 0x00097D4E
		// (set) Token: 0x06002475 RID: 9333 RVA: 0x00099B56 File Offset: 0x00097D56
		[CachedData]
		public PartyThinkParams ThinkParamsCache { get; private set; }

		// Token: 0x170008F9 RID: 2297
		// (get) Token: 0x06002476 RID: 9334 RVA: 0x00099B5F File Offset: 0x00097D5F
		public float Speed
		{
			get
			{
				return this.CalculateSpeed();
			}
		}

		// Token: 0x170008FA RID: 2298
		// (get) Token: 0x06002477 RID: 9335 RVA: 0x00099B68 File Offset: 0x00097D68
		public ExplainedNumber SpeedExplained
		{
			get
			{
				this._lastCalculatedBaseSpeedExplained = Campaign.Current.Models.PartySpeedCalculatingModel.CalculateBaseSpeed(this, true, 0, 0);
				ExplainedNumber explainedNumber = Campaign.Current.Models.PartySpeedCalculatingModel.CalculateFinalSpeed(this, this._lastCalculatedBaseSpeedExplained);
				this._lastCalculatedSpeed = explainedNumber.ResultNumber;
				return explainedNumber;
			}
		}

		// Token: 0x170008FB RID: 2299
		// (get) Token: 0x06002478 RID: 9336 RVA: 0x00099BBD File Offset: 0x00097DBD
		public MobileParty ShortTermTargetParty
		{
			get
			{
				PartyBase aiBehaviorPartyBase = this.Ai.AiBehaviorPartyBase;
				if (aiBehaviorPartyBase == null)
				{
					return null;
				}
				return aiBehaviorPartyBase.MobileParty;
			}
		}

		// Token: 0x170008FC RID: 2300
		// (get) Token: 0x06002479 RID: 9337 RVA: 0x00099BD5 File Offset: 0x00097DD5
		public Settlement ShortTermTargetSettlement
		{
			get
			{
				PartyBase aiBehaviorPartyBase = this.Ai.AiBehaviorPartyBase;
				if (aiBehaviorPartyBase == null)
				{
					return null;
				}
				return aiBehaviorPartyBase.Settlement;
			}
		}

		// Token: 0x170008FD RID: 2301
		// (get) Token: 0x0600247A RID: 9338 RVA: 0x00099BED File Offset: 0x00097DED
		public bool IsDisorganized
		{
			get
			{
				return this._isDisorganized;
			}
		}

		// Token: 0x170008FE RID: 2302
		// (get) Token: 0x0600247B RID: 9339 RVA: 0x00099BF5 File Offset: 0x00097DF5
		public bool IsCurrentlyUsedByAQuest
		{
			get
			{
				return this._isCurrentlyUsedByAQuest;
			}
		}

		// Token: 0x170008FF RID: 2303
		// (get) Token: 0x0600247C RID: 9340 RVA: 0x00099BFD File Offset: 0x00097DFD
		// (set) Token: 0x0600247D RID: 9341 RVA: 0x00099C05 File Offset: 0x00097E05
		[SaveableProperty(1050)]
		public AiBehavior ShortTermBehavior { get; internal set; }

		// Token: 0x17000900 RID: 2304
		// (get) Token: 0x0600247E RID: 9342 RVA: 0x00099C0E File Offset: 0x00097E0E
		// (set) Token: 0x0600247F RID: 9343 RVA: 0x00099C16 File Offset: 0x00097E16
		[SaveableProperty(1958)]
		public bool IsPartyTradeActive { get; private set; }

		// Token: 0x17000901 RID: 2305
		// (get) Token: 0x06002480 RID: 9344 RVA: 0x00099C1F File Offset: 0x00097E1F
		// (set) Token: 0x06002481 RID: 9345 RVA: 0x00099C27 File Offset: 0x00097E27
		public int PartyTradeGold
		{
			get
			{
				return this._partyTradeGold;
			}
			set
			{
				this._partyTradeGold = MathF.Max(value, 0);
			}
		}

		// Token: 0x17000902 RID: 2306
		// (get) Token: 0x06002482 RID: 9346 RVA: 0x00099C36 File Offset: 0x00097E36
		// (set) Token: 0x06002483 RID: 9347 RVA: 0x00099C3E File Offset: 0x00097E3E
		[SaveableProperty(1957)]
		public int PartyTradeTaxGold { get; private set; }

		// Token: 0x17000903 RID: 2307
		// (get) Token: 0x06002484 RID: 9348 RVA: 0x00099C47 File Offset: 0x00097E47
		// (set) Token: 0x06002485 RID: 9349 RVA: 0x00099C4F File Offset: 0x00097E4F
		[SaveableProperty(1960)]
		public CampaignTime StationaryStartTime { get; private set; }

		// Token: 0x17000904 RID: 2308
		// (get) Token: 0x06002486 RID: 9350 RVA: 0x00099C58 File Offset: 0x00097E58
		// (set) Token: 0x06002487 RID: 9351 RVA: 0x00099C60 File Offset: 0x00097E60
		[CachedData]
		public int VersionNo { get; private set; }

		// Token: 0x17000905 RID: 2309
		// (get) Token: 0x06002488 RID: 9352 RVA: 0x00099C69 File Offset: 0x00097E69
		// (set) Token: 0x06002489 RID: 9353 RVA: 0x00099C71 File Offset: 0x00097E71
		[SaveableProperty(1080)]
		public bool ShouldJoinPlayerBattles { get; set; }

		// Token: 0x17000906 RID: 2310
		// (get) Token: 0x0600248A RID: 9354 RVA: 0x00099C7A File Offset: 0x00097E7A
		// (set) Token: 0x0600248B RID: 9355 RVA: 0x00099C82 File Offset: 0x00097E82
		[SaveableProperty(1081)]
		public bool IsDisbanding { get; set; }

		// Token: 0x17000907 RID: 2311
		// (get) Token: 0x0600248C RID: 9356 RVA: 0x00099C8B File Offset: 0x00097E8B
		public int RandomValue
		{
			get
			{
				return this.Party.RandomValue;
			}
		}

		// Token: 0x17000908 RID: 2312
		// (get) Token: 0x0600248D RID: 9357 RVA: 0x00099C98 File Offset: 0x00097E98
		// (set) Token: 0x0600248E RID: 9358 RVA: 0x00099CA0 File Offset: 0x00097EA0
		public Settlement CurrentSettlement
		{
			get
			{
				return this._currentSettlement;
			}
			set
			{
				if (value != this._currentSettlement)
				{
					if (this._currentSettlement != null)
					{
						this._currentSettlement.RemoveMobileParty(this);
					}
					this._currentSettlement = value;
					if (this._currentSettlement != null)
					{
						this._currentSettlement.AddMobileParty(this);
						if (this._currentSettlement.IsFortification)
						{
							this.Position2D = this._currentSettlement.GatePosition;
						}
						this.LastVisitedSettlement = value;
					}
					foreach (MobileParty mobileParty in this._attachedParties)
					{
						mobileParty.CurrentSettlement = value;
					}
					if (this._currentSettlement != null && this._currentSettlement.IsFortification)
					{
						this.ArmyPositionAdder = Vec2.Zero;
						this._errorPosition = Vec2.Zero;
						this.Bearing = Vec2.Zero;
						this.Party.AverageBearingRotation = 0f;
						foreach (MobileParty mobileParty2 in this._currentSettlement.Parties)
						{
							IPartyVisual visuals = mobileParty2.Party.Visuals;
							if (visuals != null)
							{
								visuals.SetMapIconAsDirty();
							}
						}
					}
					IPartyVisual visuals2 = this.Party.Visuals;
					if (visuals2 == null)
					{
						return;
					}
					visuals2.SetMapIconAsDirty();
				}
			}
		}

		// Token: 0x17000909 RID: 2313
		// (get) Token: 0x0600248F RID: 9359 RVA: 0x00099E04 File Offset: 0x00098004
		public Settlement HomeSettlement
		{
			get
			{
				Settlement settlement;
				if ((settlement = this._customHomeSettlement) == null)
				{
					PartyComponent partyComponent = this._partyComponent;
					if (partyComponent == null)
					{
						return null;
					}
					settlement = partyComponent.HomeSettlement;
				}
				return settlement;
			}
		}

		// Token: 0x06002490 RID: 9360 RVA: 0x00099E21 File Offset: 0x00098021
		public void SetCustomHomeSettlement(Settlement customHomeSettlement)
		{
			this._customHomeSettlement = customHomeSettlement;
		}

		// Token: 0x1700090A RID: 2314
		// (get) Token: 0x06002491 RID: 9361 RVA: 0x00099E2A File Offset: 0x0009802A
		// (set) Token: 0x06002492 RID: 9362 RVA: 0x00099E32 File Offset: 0x00098032
		public MobileParty AttachedTo
		{
			get
			{
				return this._attachedTo;
			}
			set
			{
				if (this._attachedTo != value)
				{
					this.SetAttachedToInternal(value);
				}
			}
		}

		// Token: 0x06002493 RID: 9363 RVA: 0x00099E44 File Offset: 0x00098044
		private void SetAttachedToInternal(MobileParty value)
		{
			if (this._attachedTo != null)
			{
				this._attachedTo.RemoveAttachedPartyInternal(this);
				if (this.Party.MapEventSide != null)
				{
					this.Party.MapEventSide.HandleMapEventEndForPartyInternal(this.Party);
					this.Party.MapEventSide = null;
				}
				if (this.BesiegerCamp != null)
				{
					this.BesiegerCamp = null;
				}
				this.OnAttachedToRemoved();
			}
			this._attachedTo = value;
			if (this._attachedTo != null)
			{
				this._attachedTo.AddAttachedPartyInternal(this);
				this.Party.MapEventSide = this._attachedTo.Party.MapEventSide;
				this.BesiegerCamp = this._attachedTo.BesiegerCamp;
				this.CurrentSettlement = this._attachedTo.CurrentSettlement;
			}
			IPartyVisual visuals = this.Party.Visuals;
			if (visuals == null)
			{
				return;
			}
			visuals.SetMapIconAsDirty();
		}

		// Token: 0x06002494 RID: 9364 RVA: 0x00099F16 File Offset: 0x00098116
		private void AddAttachedPartyInternal(MobileParty mobileParty)
		{
			if (this._attachedParties == null)
			{
				this._attachedParties = new MBList<MobileParty>();
			}
			this._attachedParties.Add(mobileParty);
			if (CampaignEventDispatcher.Instance != null)
			{
				CampaignEventDispatcher.Instance.OnPartyAttachedAnotherParty(mobileParty);
			}
		}

		// Token: 0x06002495 RID: 9365 RVA: 0x00099F49 File Offset: 0x00098149
		private void RemoveAttachedPartyInternal(MobileParty mobileParty)
		{
			this._attachedParties.Remove(mobileParty);
		}

		// Token: 0x06002496 RID: 9366 RVA: 0x00099F58 File Offset: 0x00098158
		private void OnAttachedToRemoved()
		{
			this._errorPosition += this.ArmyPositionAdder;
			this.ArmyPositionAdder = Vec2.Zero;
			if (!this.IsVisible)
			{
				this._errorPosition = Vec2.Zero;
			}
			if (this.CurrentSettlement != null)
			{
				this.Ai.SetMoveGoToSettlement(this.CurrentSettlement);
				return;
			}
			this.Ai.SetMoveModeHold();
		}

		// Token: 0x1700090B RID: 2315
		// (get) Token: 0x06002497 RID: 9367 RVA: 0x00099FBF File Offset: 0x000981BF
		// (set) Token: 0x06002498 RID: 9368 RVA: 0x00099FC8 File Offset: 0x000981C8
		public Army Army
		{
			get
			{
				return this._army;
			}
			set
			{
				if (this._army != value)
				{
					this.UpdateVersionNo();
					if (this._army != null)
					{
						this._army.OnRemovePartyInternal(this);
					}
					this._army = value;
					if (value == null)
					{
						if (this == MobileParty.MainParty && Game.Current.GameStateManager.ActiveState is MapState)
						{
							((MapState)Game.Current.GameStateManager.ActiveState).OnLeaveArmy();
							return;
						}
					}
					else
					{
						this._army.OnAddPartyInternal(this);
						this.Ai.ResetNumberOfRecentFleeing();
					}
				}
			}
		}

		// Token: 0x1700090C RID: 2316
		// (get) Token: 0x06002499 RID: 9369 RVA: 0x0009A051 File Offset: 0x00098251
		// (set) Token: 0x0600249A RID: 9370 RVA: 0x0009A05C File Offset: 0x0009825C
		public BesiegerCamp BesiegerCamp
		{
			get
			{
				return this._besiegerCamp;
			}
			set
			{
				if (this._besiegerCamp != value && !this._besiegerCampResetStarted)
				{
					if (this._besiegerCamp != null)
					{
						this.OnPartyLeftSiegeInternal();
					}
					this._besiegerCamp = value;
					if (this._besiegerCamp != null)
					{
						this.OnPartyJoinedSiegeInternal();
					}
					foreach (MobileParty mobileParty in this._attachedParties)
					{
						mobileParty.BesiegerCamp = value;
					}
					IPartyVisual visuals = this.Party.Visuals;
					if (visuals == null)
					{
						return;
					}
					visuals.SetMapIconAsDirty();
				}
			}
		}

		// Token: 0x0600249B RID: 9371 RVA: 0x0009A0F8 File Offset: 0x000982F8
		internal void ConsiderMapEventsAndSiegesInternal(IFaction factionToConsiderAgainst)
		{
			if (this.Army != null && this.Army.Kingdom != this.MapFaction)
			{
				this.Army = null;
			}
			if (this.CurrentSettlement != null)
			{
				IFaction mapFaction = this.CurrentSettlement.MapFaction;
				if ((mapFaction != null && mapFaction.IsAtWarWith(this.MapFaction) && this.DefaultBehavior == AiBehavior.RaidSettlement) || (this.IsMainParty && PlayerEncounter.Current != null && (PlayerEncounter.Current.ForceRaid || PlayerEncounter.Current.ForceSupplies || PlayerEncounter.Current.ForceVolunteers)))
				{
					return;
				}
			}
			if (this.Party.MapEventSide != null)
			{
				IFaction mapFaction2 = this.Party.MapEventSide.OtherSide.MapFaction;
				IFaction mapFaction3 = this.Party.MapEventSide.MapFaction;
				if (mapFaction2 == null || (!mapFaction2.IsAtWarWith(this.MapFaction) && mapFaction2 == factionToConsiderAgainst))
				{
					if (this.Party == PartyBase.MainParty && PlayerEncounter.Current != null)
					{
						PlayerEncounter.Current.SetPlayerEncounterInterruptedByPeace();
					}
					this.Party.MapEventSide = null;
					this.Ai.SetMoveModeHold();
				}
				else if (mapFaction3 == null || (mapFaction3.IsAtWarWith(this.MapFaction) && mapFaction2 == factionToConsiderAgainst))
				{
					this.Party.MapEventSide = null;
					this.Ai.SetMoveModeHold();
				}
				if (this.Party == PartyBase.MainParty && PlayerEncounter.Current != null && PlayerEncounter.Battle != null && !PlayerEncounter.EncounteredParty.MapFaction.IsAtWarWith(MobileParty.MainParty.MapFaction) && PlayerEncounter.Current.IsPlayerEncounterInterruptedByPeace && Game.Current.GameStateManager.ActiveState is MapState)
				{
					PlayerEncounter.Finish(true);
				}
			}
			BattleSideEnum battleSideEnum = ((PlayerEncounter.Battle != null) ? PlayerEncounter.Battle.PlayerSide : BattleSideEnum.None);
			bool flag = PlayerEncounter.EncounterSettlement != null && PlayerEncounter.EncounterSettlement.SiegeEvent != null && PlayerEncounter.EncounterSettlement.SiegeEvent.IsPartyInvolved(this.Party);
			if (this.BesiegerCamp != null || flag)
			{
				BesiegerCamp besiegerCamp = this.BesiegerCamp;
				Settlement settlement = ((besiegerCamp != null) ? besiegerCamp.SiegeEvent.BesiegedSettlement : null) ?? PlayerEncounter.EncounterSettlement;
				BesiegerCamp besiegerCamp2 = this.BesiegerCamp;
				MobileParty mobileParty = ((besiegerCamp2 != null) ? besiegerCamp2.BesiegerParty : null) ?? PlayerEncounter.EncounterSettlement.SiegeEvent.BesiegerCamp.BesiegerParty;
				IFaction mapFaction4 = settlement.MapFaction;
				IFaction faction = ((mobileParty != null) ? mobileParty.MapFaction : null);
				if (mapFaction4 == null || (!mapFaction4.IsAtWarWith(this.MapFaction) && mapFaction4 == factionToConsiderAgainst))
				{
					if (this.Party == PartyBase.MainParty && battleSideEnum == BattleSideEnum.None)
					{
						GameMenu.ActivateGameMenu("hostile_action_end_by_peace");
					}
					else if (PlayerEncounter.Current != null && (PlayerEncounter.EncounteredParty == this.Party || (PlayerEncounter.EncounterSettlement != null && PlayerEncounter.EncounterSettlement.SiegeEvent != null && PlayerEncounter.EncounterSettlement.SiegeEvent == this.SiegeEvent)) && mobileParty != null && mobileParty == this)
					{
						PlayerEncounter.Current.SetPlayerEncounterInterruptedByPeace();
					}
					if (this.Army == null || this.Army.LeaderParty == this)
					{
						this.BesiegerCamp = null;
						if (this.Party.MapEventSide != null && !this.Party.MapEvent.IsFieldBattle)
						{
							this.Party.MapEvent.FinishSiegeEventKeepBattle();
						}
					}
				}
				else if (faction == null || (faction.IsAtWarWith(this.MapFaction) && mapFaction4 == factionToConsiderAgainst))
				{
					this.BesiegerCamp = null;
					if (this.Party.MapEventSide != null)
					{
						this.Party.MapEvent.FinishSiegeEventKeepBattle();
					}
				}
				else if (mapFaction4 != null && faction != null && this.MapFaction != mapFaction4 && this.MapFaction != faction && PlayerEncounter.EncounterSettlement != null && PlayerEncounter.EncounterSettlement.SiegeEvent != null && !PartyBase.MainParty.MapFaction.IsAtWarWith(PlayerEncounter.EncounterSettlement.SiegeEvent.BesiegerCamp.BesiegerParty.MapFaction))
				{
					PlayerEncounter.Current.SetPlayerEncounterInterruptedByPeace();
				}
			}
			if (this.CurrentSettlement != null)
			{
				IFaction mapFaction5 = this.CurrentSettlement.MapFaction;
				if (mapFaction5 != null && mapFaction5 == factionToConsiderAgainst && mapFaction5.IsAtWarWith(this.MapFaction))
				{
					if (this.IsMainParty)
					{
						if (!GameStateManager.Current.ActiveState.IsMission && this.CurrentSettlement.IsFortification)
						{
							GameMenu.SwitchToMenu("fortification_crime_rating");
						}
					}
					else if (this.Army == null)
					{
						Settlement currentSettlement = this.CurrentSettlement;
						LeaveSettlementAction.ApplyForParty(this);
						SetPartyAiAction.GetActionForPatrollingAroundSettlement(this, currentSettlement);
					}
					else if (this.Army.LeaderParty == this)
					{
						if (!this.Army.Parties.Contains(MobileParty.MainParty))
						{
							Settlement currentSettlement2 = this.CurrentSettlement;
							LeaveSettlementAction.ApplyForParty(this);
							SetPartyAiAction.GetActionForPatrollingAroundSettlement(this, currentSettlement2);
						}
						else
						{
							GameMenu.SwitchToMenu("army_left_settlement_due_to_war_declaration");
						}
					}
				}
			}
			if (this.Party == PartyBase.MainParty && PlayerEncounter.Current != null)
			{
				if (PlayerEncounter.EncounteredBattle != null)
				{
					MapEvent encounteredBattle = PlayerEncounter.EncounteredBattle;
					if (encounteredBattle.PlayerSide != BattleSideEnum.None)
					{
						if (!encounteredBattle.GetLeaderParty(encounteredBattle.PlayerSide.GetOppositeSide()).MapFaction.IsAtWarWith(MobileParty.MainParty.MapFaction))
						{
							PlayerEncounter.Current.SetPlayerEncounterInterruptedByPeace();
						}
					}
					else if (!encounteredBattle.InvolvedParties.Any((PartyBase x) => x.MapFaction.IsAtWarWith(Hero.MainHero.MapFaction)))
					{
						PlayerEncounter.Current.SetPlayerEncounterInterruptedByPeace();
					}
				}
				else if (PlayerEncounter.EncounterSettlement != null && PlayerEncounter.EncounterSettlement.IsUnderSiege && !PlayerEncounter.EncounterSettlement.SiegeEvent.BesiegerCamp.BesiegerParty.MapFaction.IsAtWarWith(MobileParty.MainParty.MapFaction) && (PlayerEncounter.PlayerIsDefender || (PlayerEncounter.PlayerIsAttacker && MobileParty.MainParty.SiegeEvent != null && !PlayerEncounter.Current.IsJoinedBattle)))
				{
					PlayerEncounter.Current.SetPlayerEncounterInterruptedByPeace();
				}
				if (PlayerEncounter.Current.IsPlayerEncounterInterruptedByPeace)
				{
					if (Game.Current.GameStateManager.ActiveState is MapState)
					{
						PlayerEncounter.Finish(true);
						return;
					}
					GameMenu.ActivateGameMenu("hostile_action_end_by_peace");
				}
			}
		}

		// Token: 0x1700090D RID: 2317
		// (get) Token: 0x0600249C RID: 9372 RVA: 0x0009A6ED File Offset: 0x000988ED
		public AiBehavior DefaultBehavior
		{
			get
			{
				return this.Ai.DefaultBehavior;
			}
		}

		// Token: 0x1700090E RID: 2318
		// (get) Token: 0x0600249D RID: 9373 RVA: 0x0009A6FA File Offset: 0x000988FA
		// (set) Token: 0x0600249E RID: 9374 RVA: 0x0009A702 File Offset: 0x00098902
		public Settlement TargetSettlement
		{
			get
			{
				return this._targetSettlement;
			}
			internal set
			{
				if (value != this._targetSettlement)
				{
					this._targetSettlement = value;
					this.Ai.DefaultBehaviorNeedsUpdate = true;
				}
			}
		}

		// Token: 0x1700090F RID: 2319
		// (get) Token: 0x0600249F RID: 9375 RVA: 0x0009A720 File Offset: 0x00098920
		// (set) Token: 0x060024A0 RID: 9376 RVA: 0x0009A728 File Offset: 0x00098928
		public Vec2 TargetPosition
		{
			get
			{
				return this._targetPosition;
			}
			internal set
			{
				if (this._targetPosition != value)
				{
					this._targetPosition = value;
					this.Ai.DefaultBehaviorNeedsUpdate = true;
				}
			}
		}

		// Token: 0x17000910 RID: 2320
		// (get) Token: 0x060024A1 RID: 9377 RVA: 0x0009A74B File Offset: 0x0009894B
		// (set) Token: 0x060024A2 RID: 9378 RVA: 0x0009A753 File Offset: 0x00098953
		public MobileParty TargetParty
		{
			get
			{
				return this._targetParty;
			}
			internal set
			{
				if (value != this._targetParty)
				{
					this._targetParty = value;
					this.Ai.DefaultBehaviorNeedsUpdate = true;
				}
			}
		}

		// Token: 0x060024A3 RID: 9379 RVA: 0x0009A774 File Offset: 0x00098974
		public MobileParty()
		{
			this._isVisible = false;
			this.IsActive = true;
			this._isCurrentlyUsedByAQuest = false;
			this.Party = new PartyBase(this);
			this.InitMembers();
			this.InitCached();
			this.Initialize();
		}

		// Token: 0x060024A4 RID: 9380 RVA: 0x0009A7EC File Offset: 0x000989EC
		private void InitMembers()
		{
			if (this._attachedParties == null)
			{
				this._attachedParties = new MBList<MobileParty>();
			}
		}

		// Token: 0x17000911 RID: 2321
		// (get) Token: 0x060024A5 RID: 9381 RVA: 0x0009A801 File Offset: 0x00098A01
		public Hero LeaderHero
		{
			get
			{
				PartyComponent partyComponent = this.PartyComponent;
				if (partyComponent == null)
				{
					return null;
				}
				return partyComponent.Leader;
			}
		}

		// Token: 0x17000912 RID: 2322
		// (get) Token: 0x060024A6 RID: 9382 RVA: 0x0009A814 File Offset: 0x00098A14
		// (set) Token: 0x060024A7 RID: 9383 RVA: 0x0009A81C File Offset: 0x00098A1C
		[SaveableProperty(1070)]
		private Hero Scout { get; set; }

		// Token: 0x17000913 RID: 2323
		// (get) Token: 0x060024A8 RID: 9384 RVA: 0x0009A825 File Offset: 0x00098A25
		// (set) Token: 0x060024A9 RID: 9385 RVA: 0x0009A82D File Offset: 0x00098A2D
		[SaveableProperty(1072)]
		private Hero Engineer { get; set; }

		// Token: 0x17000914 RID: 2324
		// (get) Token: 0x060024AA RID: 9386 RVA: 0x0009A836 File Offset: 0x00098A36
		// (set) Token: 0x060024AB RID: 9387 RVA: 0x0009A83E File Offset: 0x00098A3E
		[SaveableProperty(1071)]
		private Hero Quartermaster { get; set; }

		// Token: 0x17000915 RID: 2325
		// (get) Token: 0x060024AC RID: 9388 RVA: 0x0009A847 File Offset: 0x00098A47
		// (set) Token: 0x060024AD RID: 9389 RVA: 0x0009A84F File Offset: 0x00098A4F
		[SaveableProperty(1073)]
		private Hero Surgeon { get; set; }

		// Token: 0x17000916 RID: 2326
		// (get) Token: 0x060024AE RID: 9390 RVA: 0x0009A858 File Offset: 0x00098A58
		public Hero Owner
		{
			get
			{
				PartyComponent partyComponent = this._partyComponent;
				if (partyComponent == null)
				{
					return null;
				}
				return partyComponent.PartyOwner;
			}
		}

		// Token: 0x17000917 RID: 2327
		// (get) Token: 0x060024AF RID: 9391 RVA: 0x0009A86B File Offset: 0x00098A6B
		public Hero EffectiveScout
		{
			get
			{
				if (this.Scout == null || this.Scout.PartyBelongedTo != this)
				{
					return this.LeaderHero;
				}
				return this.Scout;
			}
		}

		// Token: 0x060024B0 RID: 9392 RVA: 0x0009A890 File Offset: 0x00098A90
		private void InitializeMobilePartyWithPartyTemplate(PartyTemplateObject pt, Vec2 position, int troopNumberLimit)
		{
			if (troopNumberLimit != 0)
			{
				this.FillPartyStacks(pt, troopNumberLimit);
			}
			this.CreateFigure(position, 0f);
			this.Ai.SetMoveModeHold();
		}

		// Token: 0x060024B1 RID: 9393 RVA: 0x0009A8B4 File Offset: 0x00098AB4
		public void SetPartyScout(Hero hero)
		{
			this.RemoveHeroPerkRole(hero);
			this.Scout = hero;
		}

		// Token: 0x060024B2 RID: 9394 RVA: 0x0009A8C4 File Offset: 0x00098AC4
		public void SetPartyQuartermaster(Hero hero)
		{
			this.RemoveHeroPerkRole(hero);
			this.Quartermaster = hero;
		}

		// Token: 0x17000918 RID: 2328
		// (get) Token: 0x060024B3 RID: 9395 RVA: 0x0009A8D4 File Offset: 0x00098AD4
		public Hero EffectiveQuartermaster
		{
			get
			{
				if (this.Quartermaster == null || this.Quartermaster.PartyBelongedTo != this)
				{
					return this.LeaderHero;
				}
				return this.Quartermaster;
			}
		}

		// Token: 0x060024B4 RID: 9396 RVA: 0x0009A8F9 File Offset: 0x00098AF9
		public void SetPartyEngineer(Hero hero)
		{
			this.RemoveHeroPerkRole(hero);
			this.Engineer = hero;
		}

		// Token: 0x060024B5 RID: 9397 RVA: 0x0009A909 File Offset: 0x00098B09
		public void InitializeMobilePartyAroundPosition(TroopRoster memberRoster, TroopRoster prisonerRoster, Vec2 position, float spawnRadius, float minSpawnRadius = 0f)
		{
			position = MobilePartyHelper.FindReachablePointAroundPosition(position, spawnRadius, minSpawnRadius);
			this.InitializeMobilePartyWithRosterInternal(memberRoster, prisonerRoster, position);
		}

		// Token: 0x060024B6 RID: 9398 RVA: 0x0009A920 File Offset: 0x00098B20
		public override void Initialize()
		{
			base.Initialize();
			this.Aggressiveness = 1f;
			this.Ai = new MobilePartyAi(this);
			CampaignEventDispatcher.Instance.OnPartyVisibilityChanged(this.Party);
		}

		// Token: 0x17000919 RID: 2329
		// (get) Token: 0x060024B7 RID: 9399 RVA: 0x0009A94F File Offset: 0x00098B4F
		public Hero EffectiveEngineer
		{
			get
			{
				if (this.Engineer == null || this.Engineer.PartyBelongedTo != this)
				{
					return this.LeaderHero;
				}
				return this.Engineer;
			}
		}

		// Token: 0x060024B8 RID: 9400 RVA: 0x0009A974 File Offset: 0x00098B74
		public void InitializeMobilePartyAtPosition(TroopRoster memberRoster, TroopRoster prisonerRoster, Vec2 position)
		{
			this.InitializeMobilePartyWithRosterInternal(memberRoster, prisonerRoster, position);
		}

		// Token: 0x060024B9 RID: 9401 RVA: 0x0009A97F File Offset: 0x00098B7F
		public void SetPartySurgeon(Hero hero)
		{
			this.RemoveHeroPerkRole(hero);
			this.Surgeon = hero;
		}

		// Token: 0x1700091A RID: 2330
		// (get) Token: 0x060024BA RID: 9402 RVA: 0x0009A98F File Offset: 0x00098B8F
		public Hero EffectiveSurgeon
		{
			get
			{
				if (this.Surgeon == null || this.Surgeon.PartyBelongedTo != this)
				{
					return this.LeaderHero;
				}
				return this.Surgeon;
			}
		}

		// Token: 0x060024BB RID: 9403 RVA: 0x0009A9B4 File Offset: 0x00098BB4
		public void InitializeMobilePartyAtPosition(PartyTemplateObject pt, Vec2 position, int troopNumberLimit = -1)
		{
			this.InitializeMobilePartyWithPartyTemplate(pt, position, troopNumberLimit);
		}

		// Token: 0x060024BC RID: 9404 RVA: 0x0009A9BF File Offset: 0x00098BBF
		public void InitializeMobilePartyAroundPosition(PartyTemplateObject pt, Vec2 position, float spawnRadius, float minSpawnRadius = 0f, int troopNumberLimit = -1)
		{
			position = MobilePartyHelper.FindReachablePointAroundPosition(position, spawnRadius, minSpawnRadius);
			this.InitializeMobilePartyWithPartyTemplate(pt, position, troopNumberLimit);
		}

		// Token: 0x060024BD RID: 9405 RVA: 0x0009A9D6 File Offset: 0x00098BD6
		private void InitializeMobilePartyWithRosterInternal(TroopRoster memberRoster, TroopRoster prisonerRoster, Vec2 position)
		{
			this.MemberRoster.Add(memberRoster);
			this.PrisonRoster.Add(prisonerRoster);
			this.CreateFigure(position, 0f);
			this.Ai.SetMoveModeHold();
		}

		// Token: 0x1700091B RID: 2331
		// (get) Token: 0x060024BE RID: 9406 RVA: 0x0009AA07 File Offset: 0x00098C07
		// (set) Token: 0x060024BF RID: 9407 RVA: 0x0009AA10 File Offset: 0x00098C10
		public Clan ActualClan
		{
			get
			{
				return this._actualClan;
			}
			set
			{
				if (this._actualClan != value)
				{
					WarPartyComponent warPartyComponent;
					if (this._actualClan != null && value != null && (warPartyComponent = this.PartyComponent as WarPartyComponent) != null)
					{
						warPartyComponent.OnClanChange(this._actualClan, value);
					}
					this._actualClan = value;
				}
			}
		}

		// Token: 0x060024C0 RID: 9408 RVA: 0x0009AA54 File Offset: 0x00098C54
		internal void StartUp()
		{
			this.Ai.StartUp();
		}

		// Token: 0x060024C1 RID: 9409 RVA: 0x0009AA64 File Offset: 0x00098C64
		[LateLoadInitializationCallback]
		private void OnLateLoad(MetaData metaData, ObjectLoadData objectLoadData)
		{
			if (MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.1.0", 17949))
			{
				PartyBase partyBase = (PartyBase)objectLoadData.GetMemberValueBySaveId(1052);
				IMapEntity mapEntity = null;
				if (partyBase != null)
				{
					if (partyBase.IsSettlement)
					{
						mapEntity = partyBase.Settlement;
					}
					else if (partyBase.IsMobile)
					{
						mapEntity = partyBase.MobileParty;
					}
				}
				object memberValueBySaveId = objectLoadData.GetMemberValueBySaveId(1036);
				object memberValueBySaveId2 = objectLoadData.GetMemberValueBySaveId(1037);
				object memberValueBySaveId3 = objectLoadData.GetMemberValueBySaveId(1064);
				object memberValueBySaveId4 = objectLoadData.GetMemberValueBySaveId(1065);
				object memberValueBySaveId5 = objectLoadData.GetMemberValueBySaveId(1047);
				object memberValueBySaveId6 = objectLoadData.GetMemberValueBySaveId(1051);
				object memberValueBySaveId7 = objectLoadData.GetMemberValueBySaveId(1038);
				object memberValueBySaveId8 = objectLoadData.GetMemberValueBySaveId(1039);
				object memberValueBySaveId9 = objectLoadData.GetMemberValueBySaveId(1055);
				object memberValueBySaveId10 = objectLoadData.GetMemberValueBySaveId(1054);
				object memberValueBySaveId11 = objectLoadData.GetMemberValueBySaveId(1062);
				object memberValueBySaveId12 = objectLoadData.GetMemberValueBySaveId(1061);
				object fieldValueBySaveId = objectLoadData.GetFieldValueBySaveId(1070);
				object memberValueBySaveId13 = objectLoadData.GetMemberValueBySaveId(1022);
				object obj = mapEntity ?? objectLoadData.GetMemberValueBySaveId(1056);
				object memberValueBySaveId14 = objectLoadData.GetMemberValueBySaveId(1074);
				if (memberValueBySaveId != null)
				{
					this.Ai.InitializeForOldSaves((float)memberValueBySaveId, (float)memberValueBySaveId2, (CampaignTime)memberValueBySaveId3, (int)memberValueBySaveId4, (AiBehavior)memberValueBySaveId5, (Vec2)memberValueBySaveId6, (bool)memberValueBySaveId7, (bool)memberValueBySaveId8, (MoveModeType)memberValueBySaveId9, (MobileParty)memberValueBySaveId10, (Vec2)memberValueBySaveId11, (Vec2)memberValueBySaveId12, (Vec2)fieldValueBySaveId, (Vec2)memberValueBySaveId13, (IMapEntity)obj, ((CampaignTime?)memberValueBySaveId14) ?? CampaignTime.Never);
				}
				this.UpdatePartyComponentFlags();
				if (this.IsGarrison || this.IsLordParty)
				{
					object memberValueBySaveId15 = objectLoadData.GetMemberValueBySaveId(1010);
					if (memberValueBySaveId15 != null)
					{
						this.SetWagePaymentLimit((int)memberValueBySaveId15);
					}
				}
			}
		}

		// Token: 0x1700091C RID: 2332
		// (get) Token: 0x060024C2 RID: 9410 RVA: 0x0009AC64 File Offset: 0x00098E64
		// (set) Token: 0x060024C3 RID: 9411 RVA: 0x0009AC6C File Offset: 0x00098E6C
		public float RecentEventsMorale
		{
			get
			{
				return this._moraleDueToEvents;
			}
			set
			{
				this._moraleDueToEvents = value;
				if (this._moraleDueToEvents < -50f)
				{
					this._moraleDueToEvents = -50f;
					return;
				}
				if (this._moraleDueToEvents > 50f)
				{
					this._moraleDueToEvents = 50f;
				}
			}
		}

		// Token: 0x060024C4 RID: 9412 RVA: 0x0009ACA6 File Offset: 0x00098EA6
		public override string ToString()
		{
			return base.StringId + ":" + this.Party.Index;
		}

		// Token: 0x1700091D RID: 2333
		// (get) Token: 0x060024C5 RID: 9413 RVA: 0x0009ACC8 File Offset: 0x00098EC8
		public float Morale
		{
			get
			{
				float resultNumber = Campaign.Current.Models.PartyMoraleModel.GetEffectivePartyMorale(this, false).ResultNumber;
				return (resultNumber < 0f) ? 0f : ((resultNumber > 100f) ? 100f : resultNumber);
			}
		}

		// Token: 0x060024C6 RID: 9414 RVA: 0x0009AD15 File Offset: 0x00098F15
		TextObject ITrackableBase.GetName()
		{
			return this.Name;
		}

		// Token: 0x1700091E RID: 2334
		// (get) Token: 0x060024C7 RID: 9415 RVA: 0x0009AD1D File Offset: 0x00098F1D
		public ExplainedNumber MoraleExplained
		{
			get
			{
				return Campaign.Current.Models.PartyMoraleModel.GetEffectivePartyMorale(this, true);
			}
		}

		// Token: 0x060024C8 RID: 9416 RVA: 0x0009AD35 File Offset: 0x00098F35
		public void ValidateSpeed()
		{
			this.CalculateSpeed();
		}

		// Token: 0x060024C9 RID: 9417 RVA: 0x0009AD40 File Offset: 0x00098F40
		public void ChangePartyLeader(Hero newLeader)
		{
			if (newLeader == null || !this.MemberRoster.Contains(newLeader.CharacterObject))
			{
				Debug.FailedAssert(string.Concat(new object[]
				{
					(newLeader != null) ? newLeader.Name : null,
					" is not a member of ",
					this.Name,
					"!\nParty leader did not change."
				}), "C:\\Develop\\MB3\\Source\\Bannerlord\\TaleWorlds.CampaignSystem\\Party\\MobileParty.cs", "ChangePartyLeader", 1035);
				return;
			}
			if (this.IsLordParty)
			{
				LordPartyComponent lordPartyComponent = this._partyComponent as LordPartyComponent;
				if (lordPartyComponent != null)
				{
					lordPartyComponent.ChangePartyOwner(newLeader);
				}
			}
			this.PartyComponent.ChangePartyLeader(newLeader);
		}

		// Token: 0x060024CA RID: 9418 RVA: 0x0009ADD6 File Offset: 0x00098FD6
		public void RemovePartyLeader()
		{
			if (this.LeaderHero == null)
			{
				return;
			}
			this.PartyComponent.ChangePartyLeader(null);
		}

		// Token: 0x060024CB RID: 9419 RVA: 0x0009ADF0 File Offset: 0x00098FF0
		private void RecoverPositionsForNavMeshUpdate()
		{
			if (this.Position2D.IsNonZero() && !PartyBase.IsPositionOkForTraveling(this.Position2D))
			{
				Debug.Print(string.Concat(new object[]
				{
					"Position of ",
					base.StringId,
					" is not valid! (",
					this.Position2D.x,
					", ",
					this.Position2D.y,
					") Party will be moved to a valid position."
				}), 0, Debug.DebugColor.White, 17592186044416UL);
				Settlement currentSettlement = this.CurrentSettlement;
				this.Position2D = ((currentSettlement != null) ? currentSettlement.GatePosition : SettlementHelper.FindNearestVillage(null, this).GatePosition);
			}
			if (this.CurrentSettlement != null)
			{
				float num = (this.CurrentSettlement.IsFortification ? Campaign.Current.Models.EncounterModel.NeededMaximumDistanceForEncounteringTown : Campaign.Current.Models.EncounterModel.NeededMaximumDistanceForEncounteringVillage);
				if (!this.CurrentSettlement.GatePosition.NearlyEquals(this.Position2D, num))
				{
					Debug.Print(string.Concat(new object[]
					{
						"Position of ",
						base.StringId,
						" is not valid! (",
						this.Position2D.x,
						", ",
						this.Position2D.y,
						") Party will be moved to a valid position."
					}), 0, Debug.DebugColor.White, 17592186044416UL);
					this.Position2D = this.CurrentSettlement.GatePosition;
				}
			}
			this.Ai.RecoverPositionsForNavMeshUpdate();
		}

		// Token: 0x060024CC RID: 9420 RVA: 0x0009AF94 File Offset: 0x00099194
		public void OnGameInitialized()
		{
			this.RecoverPositionsForNavMeshUpdate();
			Campaign campaign = Campaign.Current;
			if (campaign.MapSceneWrapper != null)
			{
				this.CurrentNavigationFace = campaign.MapSceneWrapper.GetFaceIndex(this.Position2D);
			}
			this.Ai.OnGameInitialized();
			MobileParty mobileParty = Campaign.Current.CampaignObjectManager.Find<MobileParty>((MobileParty x) => x.StringId == base.StringId);
			if (this != mobileParty)
			{
				DestroyPartyAction.Apply(null, this);
			}
		}

		// Token: 0x060024CD RID: 9421 RVA: 0x0009B000 File Offset: 0x00099200
		[LoadInitializationCallback]
		private void OnLoad(MetaData metaData, ObjectLoadData objectLoadData)
		{
			object memberValueBySaveId = objectLoadData.GetMemberValueBySaveId(1032);
			if (memberValueBySaveId != null)
			{
				this._doNotAttackMainParty = (int)memberValueBySaveId;
			}
		}

		// Token: 0x060024CE RID: 9422 RVA: 0x0009B028 File Offset: 0x00099228
		protected override void PreAfterLoad()
		{
			this.UpdatePartyComponentFlags();
			PartyComponent partyComponent = this.PartyComponent;
			if (partyComponent != null)
			{
				partyComponent.Initialize(this);
			}
			this.Ai.PreAfterLoad();
			if (this._disorganizedUntilTime.IsFuture)
			{
				this._isDisorganized = true;
			}
			if (this.LeaderHero != null && this != MobileParty.MainParty && this.LeaderHero.PartyBelongedTo != this)
			{
				DestroyPartyAction.Apply(null, this);
			}
			if (this.MapEvent == null && base.StringId.Contains("troops_of_CharacterObject"))
			{
				DestroyPartyAction.Apply(null, this);
			}
		}

		// Token: 0x060024CF RID: 9423 RVA: 0x0009B0B2 File Offset: 0x000992B2
		protected override void OnBeforeLoad()
		{
			this.Ai.OnBeforeLoad();
			this.InitMembers();
			this.InitCached();
			MobileParty attachedTo = this._attachedTo;
			if (attachedTo == null)
			{
				return;
			}
			attachedTo.AddAttachedPartyInternal(this);
		}

		// Token: 0x060024D0 RID: 9424 RVA: 0x0009B0DC File Offset: 0x000992DC
		private void InitCached()
		{
			MobilePartyAi ai = this.Ai;
			if (ai != null)
			{
				ai.InitCached();
			}
			((ILocatable<MobileParty>)this).LocatorNodeIndex = -1;
			this._partySizeRatioLastCheckVersion = -1;
			this._latestUsedPaymentRatio = -1;
			this._cachedPartySizeRatio = 1f;
			this.VersionNo = 0;
			this._partyPureSpeedLastCheckVersion = -1;
			this._itemRosterVersionNo = -1;
			this.ThinkParamsCache = new PartyThinkParams(this);
		}

		// Token: 0x060024D1 RID: 9425 RVA: 0x0009B13C File Offset: 0x0009933C
		protected override void AfterLoad()
		{
			this.Party.AfterLoad();
			if (this.IsGarrison && this.MapEvent == null && this.SiegeEvent == null && this.TargetParty != null && this.CurrentSettlement != null)
			{
				this.Ai.SetMoveModeHold();
			}
			if (this.CurrentSettlement != null && !this.CurrentSettlement.Parties.Contains(this))
			{
				this.CurrentSettlement.AddMobileParty(this);
				foreach (MobileParty mobileParty in this._attachedParties)
				{
					if (this.Army.LeaderParty != this)
					{
						this.CurrentSettlement.AddMobileParty(mobileParty);
					}
				}
			}
			if (this._doNotAttackMainParty > 0)
			{
				this.Ai.DoNotAttackMainPartyUntil = CampaignTime.HoursFromNow((float)this._doNotAttackMainParty);
			}
			if (this.IsCaravan && this.Army != null)
			{
				this.Army = null;
			}
			if (MBSaveLoad.IsUpdatingGameVersion && MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.1.0", 17949) && (this.PaymentLimit == 2000 || (this == MobileParty.MainParty && this.PaymentLimit == 0)))
			{
				this.SetWagePaymentLimit(Campaign.Current.Models.PartyWageModel.MaxWage);
			}
			if (MBSaveLoad.IsUpdatingGameVersion && MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.1.4", 17949) && ((this.TargetParty != null && !this.TargetParty.MapFaction.IsAtWarWith(this.MapFaction)) || (this.TargetSettlement != null && !this.TargetSettlement.MapFaction.IsAtWarWith(this.MapFaction)) || (this.ShortTermTargetParty != null && !this.ShortTermTargetParty.MapFaction.IsAtWarWith(this.MapFaction))))
			{
				this.Ai.SetMoveModeHold();
			}
		}

		// Token: 0x060024D2 RID: 9426 RVA: 0x0009B328 File Offset: 0x00099528
		internal void OnFinishLoadState()
		{
			Campaign.Current.MobilePartyLocator.UpdateLocator(this);
		}

		// Token: 0x1700091F RID: 2335
		// (get) Token: 0x060024D3 RID: 9427 RVA: 0x0009B33B File Offset: 0x0009953B
		// (set) Token: 0x060024D4 RID: 9428 RVA: 0x0009B343 File Offset: 0x00099543
		int ILocatable<MobileParty>.LocatorNodeIndex
		{
			get
			{
				return this._locatorNodeIndex;
			}
			set
			{
				this._locatorNodeIndex = value;
			}
		}

		// Token: 0x17000920 RID: 2336
		// (get) Token: 0x060024D5 RID: 9429 RVA: 0x0009B34C File Offset: 0x0009954C
		// (set) Token: 0x060024D6 RID: 9430 RVA: 0x0009B354 File Offset: 0x00099554
		[CachedData]
		public PathFaceRecord CurrentNavigationFace
		{
			get
			{
				return this._currentNavigationFace;
			}
			private set
			{
				this._lastNavigationFace = this.CurrentNavigationFace;
				this._currentNavigationFace = value;
			}
		}

		// Token: 0x060024D7 RID: 9431 RVA: 0x0009B36C File Offset: 0x0009956C
		internal void HourlyTick()
		{
			if (this.IsActive)
			{
				if (this.LeaderHero != null && this.CurrentSettlement != null && this.CurrentSettlement == this.LeaderHero.HomeSettlement)
				{
					Hero leaderHero = this.LeaderHero;
					float passedTimeAtHomeSettlement = leaderHero.PassedTimeAtHomeSettlement;
					leaderHero.PassedTimeAtHomeSettlement = passedTimeAtHomeSettlement + 1f;
				}
				this.Ai.HourlyTick();
			}
		}

		// Token: 0x060024D8 RID: 9432 RVA: 0x0009B3C8 File Offset: 0x000995C8
		internal void DailyTick()
		{
			this.RecentEventsMorale -= this.RecentEventsMorale * 0.1f;
			if (this.LeaderHero != null)
			{
				this.LeaderHero.PassedTimeAtHomeSettlement *= 0.9f;
			}
		}

		// Token: 0x060024D9 RID: 9433 RVA: 0x0009B402 File Offset: 0x00099602
		internal void TickForStationaryMobileParty(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			if (this.StationaryStartTime == CampaignTime.Never)
			{
				this.StationaryStartTime = CampaignTime.Now;
			}
			this.CheckIsDisorganized();
			this.DoUpdatePosition(ref variables, dt, realDt);
			this.DoErrorCorrections(ref variables, realDt);
		}

		// Token: 0x060024DA RID: 9434 RVA: 0x0009B438 File Offset: 0x00099638
		internal void TickForMovingMobileParty(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			this.ComputeNextMoveDistance(ref variables, dt);
			this.CommonMovingPartyTick(ref variables, dt, realDt);
		}

		// Token: 0x060024DB RID: 9435 RVA: 0x0009B44B File Offset: 0x0009964B
		internal void TickForMovingArmyLeader(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			this.ComputeNextMoveDistanceForArmyLeader(ref variables, dt);
			this.CommonMovingPartyTick(ref variables, dt, realDt);
		}

		// Token: 0x060024DC RID: 9436 RVA: 0x0009B45E File Offset: 0x0009965E
		internal void CommonMovingPartyTick(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			this.StationaryStartTime = CampaignTime.Never;
			this.CheckIsDisorganized();
			this.Ai.DoAiPathMode(ref variables);
			this.DoUpdatePosition(ref variables, dt, realDt);
			this.DoErrorCorrections(ref variables, realDt);
		}

		// Token: 0x060024DD RID: 9437 RVA: 0x0009B490 File Offset: 0x00099690
		internal void InitializeCachedPartyVariables(ref MobileParty.CachedPartyVariables variables)
		{
			variables.HasMapEvent = this.MapEvent != null;
			variables.CurrentPosition = this.Position2D;
			variables.TargetPartyPositionAtFrameStart = Vec2.Invalid;
			variables.LastCurrentPosition = this.Position2D;
			variables.IsAttachedArmyMember = false;
			variables.IsMoving = this.IsMoving || this.IsMainParty;
			variables.IsArmyLeader = false;
			if (this.Army != null)
			{
				if (this.Army.LeaderParty == this)
				{
					variables.IsArmyLeader = true;
					return;
				}
				if (this.Army.LeaderParty.AttachedParties.Contains(this))
				{
					variables.IsAttachedArmyMember = true;
				}
			}
		}

		// Token: 0x060024DE RID: 9438 RVA: 0x0009B531 File Offset: 0x00099731
		internal void ComputeNextMoveDistanceForArmyLeader(ref MobileParty.CachedPartyVariables variables, float dt)
		{
			if (dt > 0f)
			{
				this.CalculateSpeedForPartyUnified();
				variables.NextMoveDistance = this.Speed * dt;
				return;
			}
			variables.NextMoveDistance = 0f;
		}

		// Token: 0x060024DF RID: 9439 RVA: 0x0009B55C File Offset: 0x0009975C
		internal void ComputeNextMoveDistance(ref MobileParty.CachedPartyVariables variables, float dt)
		{
			if (dt > 0f)
			{
				this.CalculateSpeed();
				variables.NextMoveDistance = this.Speed * dt;
				return;
			}
			variables.NextMoveDistance = 0f;
		}

		// Token: 0x060024E0 RID: 9440 RVA: 0x0009B587 File Offset: 0x00099787
		internal void UpdateStationaryTimer()
		{
			if (!this.IsMoving)
			{
				if (this.StationaryStartTime == CampaignTime.Never)
				{
					this.StationaryStartTime = CampaignTime.Now;
					return;
				}
			}
			else
			{
				this.StationaryStartTime = CampaignTime.Never;
			}
		}

		// Token: 0x060024E1 RID: 9441 RVA: 0x0009B5BA File Offset: 0x000997BA
		private void CheckIsDisorganized()
		{
			if (this._isDisorganized && this._disorganizedUntilTime.IsPast)
			{
				this.SetDisorganized(false);
			}
		}

		// Token: 0x060024E2 RID: 9442 RVA: 0x0009B5D8 File Offset: 0x000997D8
		public void SetDisorganized(bool isDisorganized)
		{
			if (isDisorganized)
			{
				this._disorganizedUntilTime = CampaignTime.HoursFromNow(Campaign.Current.Models.PartyImpairmentModel.GetDisorganizedStateDuration(this));
			}
			this._isDisorganized = isDisorganized;
			this.UpdateVersionNo();
		}

		// Token: 0x060024E3 RID: 9443 RVA: 0x0009B60C File Offset: 0x0009980C
		internal void DoUpdatePosition(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			variables.NextPosition = variables.CurrentPosition;
			Vec2 vec = variables.CurrentPosition + this.EventPositionAdder + this.ArmyPositionAdder;
			Vec2 vec2;
			if (variables.IsAttachedArmyMember)
			{
				if (variables.HasMapEvent || this.CurrentSettlement != null)
				{
					vec2 = Vec2.Zero;
				}
				else
				{
					Vec2 vec3 = (variables.HasMapEvent ? this.Army.LeaderParty.Position2D : this.Army.LeaderParty.Ai.NextTargetPosition);
					Vec2 vec4;
					PathFaceRecord pathFaceRecord;
					bool flag;
					this.Army.LeaderParty.Ai.GetTargetPositionAndFace(ref variables, out vec4, out pathFaceRecord, out flag);
					Vec2 vec5 = (((vec3 - this.Army.LeaderParty.Position2D).LengthSquared < 0.0025000002f) ? Vec2.FromRotation(this.Army.LeaderParty.Party.AverageBearingRotation) : (vec3 - this.Army.LeaderParty.Position2D).Normalized());
					Vec2 vec6 = vec5.TransformToParentUnitF(this.Army.GetRelativePositionForParty(this, vec5));
					vec2 = vec3 + vec6 - vec;
					if ((vec4 + vec6 - vec).LengthSquared < 0.010000001f || vec2.LengthSquared < (this.Party.Visuals.EntityMoving ? 0.0001f : 0.010000001f))
					{
						vec2 = Vec2.Zero;
					}
					float num = vec2.LeftVec().Normalized().DotProduct(this.Army.LeaderParty.Position2D + vec6 - vec);
					vec2.RotateCCW((num < 0f) ? MathF.Max(num * 2f, -0.7853982f) : MathF.Min(num * 2f, 0.7853982f));
				}
			}
			else
			{
				vec2 = (variables.HasMapEvent ? this.Party.MapEvent.Position : this.Ai.NextTargetPosition) - vec;
			}
			float num2 = vec2.Normalize();
			this.Party.Visuals.EntityMoving = false;
			if (num2 < variables.NextMoveDistance)
			{
				variables.NextMoveDistance = num2;
			}
			if (this.BesiegedSettlement == null && this.CurrentSettlement == null)
			{
				if (variables.NextMoveDistance > 0f || variables.HasMapEvent)
				{
					bool flag2 = false;
					Vec2 vec7 = this.Bearing;
					if (num2 > 0f)
					{
						flag2 = true;
						vec7 = vec2;
						if (!variables.IsAttachedArmyMember || !variables.HasMapEvent)
						{
							this.Bearing = vec7;
						}
						this.Party.Visuals.EntityMoving = !variables.HasMapEvent;
					}
					else if (variables.IsAttachedArmyMember && variables.HasMapEvent)
					{
						vec7 = this.Army.LeaderParty.Bearing;
						this.Bearing = vec7;
						flag2 = true;
					}
					if (flag2)
					{
						float num3 = MBMath.WrapAngle(this.Bearing.RotationInRadians - this.Party.AverageBearingRotation);
						float num4 = (variables.HasMapEvent ? realDt : dt);
						this.Party.AverageBearingRotation += num3 * MathF.Min(num4 * 30f, 1f);
						this.Party.AverageBearingRotation = MBMath.WrapAngle(this.Party.AverageBearingRotation);
					}
					variables.NextPosition = variables.CurrentPosition + vec7 * variables.NextMoveDistance;
					return;
				}
				if (num2 > 0.1f)
				{
					this.Party.Visuals.EntityMoving = true;
				}
			}
		}

		// Token: 0x060024E4 RID: 9444 RVA: 0x0009B9A4 File Offset: 0x00099BA4
		internal void DoErrorCorrections(ref MobileParty.CachedPartyVariables variables, float realDt)
		{
			float lengthSquared = this._errorPosition.LengthSquared;
			if (lengthSquared > 0f)
			{
				if (this.CurrentSettlement != null || !this.IsVisible)
				{
					this._errorPosition = Vec2.Zero;
				}
				if ((double)lengthSquared <= 49.0 * (double)realDt * (double)realDt)
				{
					this._errorPosition = Vec2.Zero;
					return;
				}
				this.Party.Visuals.EntityMoving = true;
				this._errorPosition -= this._errorPosition.Normalized() * (7f * realDt);
			}
		}

		// Token: 0x060024E5 RID: 9445 RVA: 0x0009BA38 File Offset: 0x00099C38
		internal void TickForMobileParty2(ref MobileParty.CachedPartyVariables variables, float realDt, ref int gridChangeCount, ref MobileParty[] gridChangeMobilePartyList)
		{
			variables.NextPathFaceRecord = Campaign.Current.MapSceneWrapper.GetFaceIndex(variables.NextPosition);
			if (variables.NextMoveDistance > 0f && variables.IsMoving && this.BesiegedSettlement == null && !variables.HasMapEvent)
			{
				if (variables.IsAttachedArmyMember && (this.Army.LeaderParty.Position2D - (this.Position2D + this.ArmyPositionAdder)).Length > 0.25f)
				{
					this._position2D = this.Army.LeaderParty.Position2D;
					this.ArmyPositionAdder += variables.NextPosition - this.Position2D;
				}
				else
				{
					PathFaceRecord nextPathFaceRecord = variables.NextPathFaceRecord;
					if (this.CurrentNavigationFace.IsValid() && this.CurrentNavigationFace.FaceIslandIndex == nextPathFaceRecord.FaceIslandIndex)
					{
						this.SetPositionParallel(variables, variables.NextPosition, ref gridChangeCount, ref gridChangeMobilePartyList);
					}
				}
			}
			if (this.Party.Visuals.IsVisibleOrFadingOut())
			{
				MatrixFrame identity = MatrixFrame.Identity;
				identity.origin = this.GetVisualPosition();
				if (variables.IsAttachedArmyMember)
				{
					MatrixFrame frame = this.Party.Visuals.GetFrame();
					Vec2 vec = identity.origin.AsVec2 - frame.origin.AsVec2;
					if (vec.Length / realDt > 20f)
					{
						identity.rotation.RotateAboutUp(this.Party.AverageBearingRotation);
					}
					else if (this.CurrentSettlement == null)
					{
						float num = MBMath.LerpRadians(frame.rotation.f.AsVec2.RotationInRadians, (vec + Vec2.FromRotation(this.Party.AverageBearingRotation) * 0.01f).RotationInRadians, 6f * realDt, 0.03f * realDt, 10f * realDt);
						identity.rotation.RotateAboutUp(num);
					}
					else
					{
						float rotationInRadians = frame.rotation.f.AsVec2.RotationInRadians;
						identity.rotation.RotateAboutUp(rotationInRadians);
					}
				}
				else if (this.CurrentSettlement == null)
				{
					identity.rotation.RotateAboutUp(this.Party.AverageBearingRotation);
				}
				this.Party.Visuals.SetFrame(ref identity);
			}
		}

		// Token: 0x17000921 RID: 2337
		// (get) Token: 0x060024E6 RID: 9446 RVA: 0x0009BCAB File Offset: 0x00099EAB
		// (set) Token: 0x060024E7 RID: 9447 RVA: 0x0009BCB3 File Offset: 0x00099EB3
		public Vec2 EventPositionAdder
		{
			get
			{
				return this._eventPositionAdder;
			}
			set
			{
				this._errorPosition += this._eventPositionAdder;
				this._eventPositionAdder = value;
				this._errorPosition -= this._eventPositionAdder;
			}
		}

		// Token: 0x17000922 RID: 2338
		// (get) Token: 0x060024E8 RID: 9448 RVA: 0x0009BCEA File Offset: 0x00099EEA
		// (set) Token: 0x060024E9 RID: 9449 RVA: 0x0009BCF2 File Offset: 0x00099EF2
		public bool IsVisible
		{
			get
			{
				return this._isVisible;
			}
			set
			{
				if (this._isVisible != value)
				{
					this._isVisible = value;
					this.Party.OnVisibilityChanged(value);
				}
			}
		}

		// Token: 0x17000923 RID: 2339
		// (get) Token: 0x060024EA RID: 9450 RVA: 0x0009BD10 File Offset: 0x00099F10
		// (set) Token: 0x060024EB RID: 9451 RVA: 0x0009BD18 File Offset: 0x00099F18
		public Vec2 Position2D
		{
			get
			{
				return this._position2D;
			}
			set
			{
				if (this._position2D != value)
				{
					this._position2D = value;
					Campaign campaign = Campaign.Current;
					campaign.MobilePartyLocator.UpdateLocator(this);
					if (campaign.MapSceneWrapper != null)
					{
						this.CurrentNavigationFace = campaign.MapSceneWrapper.GetFaceIndex(this._position2D);
					}
				}
			}
		}

		// Token: 0x060024EC RID: 9452 RVA: 0x0009BD6C File Offset: 0x00099F6C
		private void SetPositionParallel(MobileParty.CachedPartyVariables variables, Vec2 value, ref int GridChangeCounter, ref MobileParty[] GridChangeList)
		{
			if (this._position2D != value)
			{
				this._position2D = value;
				if (!Campaign.Current.MobilePartyLocator.CheckWhetherPositionsAreInSameNode(value, this))
				{
					int num = Interlocked.Increment(ref GridChangeCounter);
					GridChangeList[num] = this;
				}
				this.CurrentNavigationFace = variables.NextPathFaceRecord;
			}
		}

		// Token: 0x060024ED RID: 9453 RVA: 0x0009BDBA File Offset: 0x00099FBA
		public void SetCustomName(TextObject name)
		{
			this.CustomName = name;
		}

		// Token: 0x060024EE RID: 9454 RVA: 0x0009BDC3 File Offset: 0x00099FC3
		public void SetPartyUsedByQuest(bool isActivelyUsed)
		{
			this._isCurrentlyUsedByAQuest = isActivelyUsed;
		}

		// Token: 0x060024EF RID: 9455 RVA: 0x0009BDCC File Offset: 0x00099FCC
		public void ResetTargetParty()
		{
			this.TargetParty = null;
		}

		// Token: 0x17000924 RID: 2340
		// (get) Token: 0x060024F0 RID: 9456 RVA: 0x0009BDD5 File Offset: 0x00099FD5
		// (set) Token: 0x060024F1 RID: 9457 RVA: 0x0009BDF9 File Offset: 0x00099FF9
		public bool IsInspected
		{
			get
			{
				return (this.Army != null && this.Army == MobileParty.MainParty.Army) || this._isInspected;
			}
			set
			{
				this._isInspected = value;
			}
		}

		// Token: 0x060024F2 RID: 9458 RVA: 0x0009BE02 File Offset: 0x0009A002
		public void IgnoreForHours(float hours)
		{
			this._ignoredUntilTime = CampaignTime.HoursFromNow(hours);
		}

		// Token: 0x060024F3 RID: 9459 RVA: 0x0009BE10 File Offset: 0x0009A010
		public void IgnoreByOtherPartiesTill(CampaignTime time)
		{
			this._ignoredUntilTime = time;
		}

		// Token: 0x060024F4 RID: 9460 RVA: 0x0009BE19 File Offset: 0x0009A019
		public void ResetBesiegedSettlement()
		{
			if (!this._besiegerCampResetStarted)
			{
				this._besiegerCampResetStarted = true;
				if (this.BesiegerCamp != null)
				{
					this.BesiegerCamp = null;
				}
				this._besiegerCampResetStarted = false;
			}
		}

		// Token: 0x17000925 RID: 2341
		// (get) Token: 0x060024F5 RID: 9461 RVA: 0x0009BE40 File Offset: 0x0009A040
		public Vec2 GetPosition2D
		{
			get
			{
				return this.Position2D;
			}
		}

		// Token: 0x17000926 RID: 2342
		// (get) Token: 0x060024F6 RID: 9462 RVA: 0x0009BE48 File Offset: 0x0009A048
		public int TotalWage
		{
			get
			{
				return (int)Campaign.Current.Models.PartyWageModel.GetTotalWage(this, false).ResultNumber;
			}
		}

		// Token: 0x17000927 RID: 2343
		// (get) Token: 0x060024F7 RID: 9463 RVA: 0x0009BE74 File Offset: 0x0009A074
		public ExplainedNumber TotalWageExplained
		{
			get
			{
				return Campaign.Current.Models.PartyWageModel.GetTotalWage(this, true);
			}
		}

		// Token: 0x17000928 RID: 2344
		// (get) Token: 0x060024F8 RID: 9464 RVA: 0x0009BE8C File Offset: 0x0009A08C
		public MapEvent MapEvent
		{
			get
			{
				return this.Party.MapEvent;
			}
		}

		// Token: 0x060024F9 RID: 9465 RVA: 0x0009BE9C File Offset: 0x0009A09C
		internal void OnRemovedFromArmyInternal()
		{
			this.ResetTargetParty();
			if (this.IsActive && this.LeaderHero != null)
			{
				if (this.BesiegedSettlement != null && this.Army.LeaderParty != this)
				{
					if (!this.BesiegedSettlement.SiegeEvent.BesiegerCamp.HasInvolvedPartyForEventType(this.Party, MapEvent.BattleTypes.Siege))
					{
						if (this == MobileParty.MainParty)
						{
							this.Ai.SetMoveModeHold();
							return;
						}
						if (this.MapEvent == null)
						{
							this.Ai.SetMoveBesiegeSettlement(this.BesiegedSettlement);
							return;
						}
					}
				}
				else
				{
					if (this.CurrentSettlement == null)
					{
						this.Ai.SetMoveModeHold();
						return;
					}
					if ((this.CurrentSettlement != null && this.CurrentSettlement == this.BesiegedSettlement) || this.MapEvent != null)
					{
						LeaveSettlementAction.ApplyForParty(this);
						return;
					}
					this.Ai.SetMoveGoToSettlement(this.CurrentSettlement);
				}
			}
		}

		// Token: 0x060024FA RID: 9466 RVA: 0x0009BF74 File Offset: 0x0009A174
		private void OnRemoveParty()
		{
			this.Army = null;
			this.CurrentSettlement = null;
			this.AttachedTo = null;
			this.BesiegerCamp = null;
			List<Settlement> list = new List<Settlement>();
			if (this.CurrentSettlement != null)
			{
				list.Add(this.CurrentSettlement);
			}
			else if ((this.IsGarrison || this.IsMilitia || this.IsBandit || this.IsVillager) && this.HomeSettlement != null)
			{
				list.Add(this.HomeSettlement);
			}
			PartyComponent partyComponent = this.PartyComponent;
			if (partyComponent != null)
			{
				partyComponent.Finish();
			}
			this.ActualClan = null;
			Campaign.Current.CampaignObjectManager.RemoveMobileParty(this);
			foreach (Settlement settlement in list)
			{
				settlement.SettlementComponent.OnRelatedPartyRemoved(this);
			}
		}

		// Token: 0x060024FB RID: 9467 RVA: 0x0009C05C File Offset: 0x0009A25C
		public void SetPartyObjective(MobileParty.PartyObjective objective)
		{
			this.Objective = objective;
		}

		// Token: 0x060024FC RID: 9468 RVA: 0x0009C068 File Offset: 0x0009A268
		public void UpdateVersionNo()
		{
			int versionNo = this.VersionNo;
			this.VersionNo = versionNo + 1;
		}

		// Token: 0x17000929 RID: 2345
		// (get) Token: 0x060024FD RID: 9469 RVA: 0x0009C085 File Offset: 0x0009A285
		public TroopRoster MemberRoster
		{
			get
			{
				return this.Party.MemberRoster;
			}
		}

		// Token: 0x1700092A RID: 2346
		// (get) Token: 0x060024FE RID: 9470 RVA: 0x0009C092 File Offset: 0x0009A292
		public TroopRoster PrisonRoster
		{
			get
			{
				return this.Party.PrisonRoster;
			}
		}

		// Token: 0x060024FF RID: 9471 RVA: 0x0009C0A0 File Offset: 0x0009A2A0
		private bool IsLastSpeedCacheInvalid()
		{
			Hero leaderHero = this.LeaderHero;
			bool flag = !this.IsActive || leaderHero == null || leaderHero.PartyBelongedToAsPrisoner != null;
			bool isNight = Campaign.Current.IsNight;
			return this._lastNavigationFace.FaceIndex != this.CurrentNavigationFace.FaceIndex || this._partyLastCheckIsPrisoner != flag || this._partyLastCheckAtNight != isNight;
		}

		// Token: 0x06002500 RID: 9472 RVA: 0x0009C109 File Offset: 0x0009A309
		private bool IsBaseSpeedCacheInvalid()
		{
			return this._partyPureSpeedLastCheckVersion != this.VersionNo || this._itemRosterVersionNo != this.Party.ItemRoster.VersionNo;
		}

		// Token: 0x06002501 RID: 9473 RVA: 0x0009C138 File Offset: 0x0009A338
		private float CalculateSpeedForPartyUnified()
		{
			bool flag = false;
			if (this.IsBaseSpeedCacheInvalid())
			{
				if (this.Army != null && this.Army.LeaderParty.AttachedParties.Contains(this))
				{
					this._lastCalculatedBaseSpeedExplained = this.Army.LeaderParty._lastCalculatedBaseSpeedExplained;
				}
				else
				{
					this._lastCalculatedBaseSpeedExplained = Campaign.Current.Models.PartySpeedCalculatingModel.CalculateBaseSpeed(this, false, 0, 0);
				}
				this._partyPureSpeedLastCheckVersion = this.VersionNo;
				this._itemRosterVersionNo = this.Party.ItemRoster.VersionNo;
				flag = true;
			}
			if (flag)
			{
				this._lastCalculatedSpeed = Campaign.Current.Models.PartySpeedCalculatingModel.CalculateFinalSpeed(this, this._lastCalculatedBaseSpeedExplained).ResultNumber;
			}
			else if (this.IsLastSpeedCacheInvalid())
			{
				Hero leaderHero = this.LeaderHero;
				bool flag2 = !this.IsActive || leaderHero == null || leaderHero.PartyBelongedToAsPrisoner != null;
				bool isNight = Campaign.Current.IsNight;
				this._lastNavigationFace = this.CurrentNavigationFace;
				this._partyLastCheckIsPrisoner = flag2;
				this._partyLastCheckAtNight = isNight;
				this._lastCalculatedSpeed = Campaign.Current.Models.PartySpeedCalculatingModel.CalculateFinalSpeed(this, this._lastCalculatedBaseSpeedExplained).ResultNumber;
			}
			return this._lastCalculatedSpeed;
		}

		// Token: 0x06002502 RID: 9474 RVA: 0x0009C274 File Offset: 0x0009A474
		private float CalculateSpeed()
		{
			if (this.Army != null)
			{
				if (this.Army.LeaderParty.AttachedParties.Contains(this))
				{
					Vec2 vec = (((this.Army.LeaderParty.MapEvent != null) ? this.Army.LeaderParty.Position2D : this.Army.LeaderParty.Ai.NextTargetPosition) - this.Army.LeaderParty.Position2D).Normalized();
					Vec2 vec2 = this.Army.LeaderParty.Position2D + vec.TransformToParentUnitF(this.Army.GetRelativePositionForParty(this, vec));
					float num = this.Bearing.DotProduct(vec2 - this.VisualPosition2DWithoutError);
					return this.Army.LeaderParty._lastCalculatedSpeed * MBMath.ClampFloat(1f + num * 1f, 0.7f, 1.3f);
				}
			}
			else if (this.DefaultBehavior == AiBehavior.EscortParty && this.TargetParty != null && this._lastCalculatedSpeed > this.TargetParty._lastCalculatedSpeed)
			{
				return this.TargetParty._lastCalculatedSpeed;
			}
			return this.CalculateSpeedForPartyUnified();
		}

		// Token: 0x1700092B RID: 2347
		// (get) Token: 0x06002503 RID: 9475 RVA: 0x0009C3A8 File Offset: 0x0009A5A8
		public ItemRoster ItemRoster
		{
			get
			{
				return this.Party.ItemRoster;
			}
		}

		// Token: 0x06002504 RID: 9476 RVA: 0x0009C3B5 File Offset: 0x0009A5B5
		public bool IsSpotted()
		{
			return this.IsVisible;
		}

		// Token: 0x1700092C RID: 2348
		// (get) Token: 0x06002505 RID: 9477 RVA: 0x0009C3BD File Offset: 0x0009A5BD
		public bool IsMainParty
		{
			get
			{
				return this == MobileParty.MainParty;
			}
		}

		// Token: 0x06002506 RID: 9478 RVA: 0x0009C3C7 File Offset: 0x0009A5C7
		public int AddElementToMemberRoster(CharacterObject element, int numberToAdd, bool insertAtFront = false)
		{
			return this.Party.AddElementToMemberRoster(element, numberToAdd, insertAtFront);
		}

		// Token: 0x06002507 RID: 9479 RVA: 0x0009C3D7 File Offset: 0x0009A5D7
		public int AddPrisoner(CharacterObject element, int numberToAdd)
		{
			return this.Party.AddPrisoner(element, numberToAdd);
		}

		// Token: 0x1700092D RID: 2349
		// (get) Token: 0x06002508 RID: 9480 RVA: 0x0009C3E8 File Offset: 0x0009A5E8
		public IFaction MapFaction
		{
			get
			{
				IFaction faction;
				if (this.ActualClan != null)
				{
					faction = this.ActualClan.MapFaction;
				}
				else if (this.Party.Owner != null)
				{
					if (this.Party.Owner == Hero.MainHero)
					{
						faction = this.Party.Owner.MapFaction;
					}
					else if (this.Party.Owner.IsNotable)
					{
						faction = this.Party.Owner.HomeSettlement.MapFaction;
					}
					else
					{
						if (this.IsMilitia || this.IsGarrison || this.IsVillager)
						{
							Settlement homeSettlement = this.HomeSettlement;
							if (((homeSettlement != null) ? homeSettlement.OwnerClan : null) != null)
							{
								return this.HomeSettlement.OwnerClan.MapFaction;
							}
						}
						if (this.IsCaravan || this.IsBanditBossParty)
						{
							faction = this.Party.Owner.MapFaction;
						}
						else if (this._isCurrentlyUsedByAQuest && this.Party.Owner != null)
						{
							faction = this.Party.Owner.MapFaction;
						}
						else
						{
							IFaction faction3;
							if (this.LeaderHero == null)
							{
								IFaction faction2 = CampaignData.NeutralFaction;
								faction3 = faction2;
							}
							else
							{
								faction3 = this.LeaderHero.MapFaction;
							}
							faction = faction3;
						}
					}
				}
				else if (this.HomeSettlement != null)
				{
					faction = this.HomeSettlement.OwnerClan.MapFaction;
				}
				else
				{
					IFaction faction4;
					if (this.LeaderHero == null)
					{
						IFaction faction2 = CampaignData.NeutralFaction;
						faction4 = faction2;
					}
					else
					{
						faction4 = this.LeaderHero.MapFaction;
					}
					faction = faction4;
				}
				return faction;
			}
		}

		// Token: 0x1700092E RID: 2350
		// (get) Token: 0x06002509 RID: 9481 RVA: 0x0009C558 File Offset: 0x0009A758
		public TextObject ArmyName
		{
			get
			{
				if (this.Army == null || this.Army.LeaderParty != this)
				{
					return this.Name;
				}
				return this.Army.Name;
			}
		}

		// Token: 0x1700092F RID: 2351
		// (get) Token: 0x0600250A RID: 9482 RVA: 0x0009C582 File Offset: 0x0009A782
		public SiegeEvent SiegeEvent
		{
			get
			{
				BesiegerCamp besiegerCamp = this.BesiegerCamp;
				if (besiegerCamp == null)
				{
					return null;
				}
				return besiegerCamp.SiegeEvent;
			}
		}

		// Token: 0x17000930 RID: 2352
		// (get) Token: 0x0600250B RID: 9483 RVA: 0x0009C595 File Offset: 0x0009A795
		public float Food
		{
			get
			{
				return (float)this.Party.RemainingFoodPercentage * 0.01f + (float)this.TotalFoodAtInventory;
			}
		}

		// Token: 0x0600250C RID: 9484 RVA: 0x0009C5B4 File Offset: 0x0009A7B4
		public Vec3 GetLogicalPosition()
		{
			float num = 0f;
			Campaign.Current.MapSceneWrapper.GetHeightAtPoint(this.Position2D, ref num);
			return new Vec3(this.Position2D.x, this.Position2D.y, num, -1f);
		}

		// Token: 0x17000931 RID: 2353
		// (get) Token: 0x0600250D RID: 9485 RVA: 0x0009C600 File Offset: 0x0009A800
		public int TotalFoodAtInventory
		{
			get
			{
				return this.ItemRoster.TotalFood;
			}
		}

		// Token: 0x0600250E RID: 9486 RVA: 0x0009C610 File Offset: 0x0009A810
		public Vec3 GetVisualPosition()
		{
			float num = 0f;
			Campaign.Current.MapSceneWrapper.GetHeightAtPoint(this.VisualPosition2DWithoutError + this._errorPosition, ref num);
			return new Vec3(this.Position2D.x + this.EventPositionAdder.x + this.ArmyPositionAdder.x + this._errorPosition.x, this.Position2D.y + this.EventPositionAdder.y + this.ArmyPositionAdder.y + this._errorPosition.y, num, -1f);
		}

		// Token: 0x17000932 RID: 2354
		// (get) Token: 0x0600250F RID: 9487 RVA: 0x0009C6AF File Offset: 0x0009A8AF
		public float TotalWeightCarried
		{
			get
			{
				return this.ItemRoster.TotalWeight;
			}
		}

		// Token: 0x17000933 RID: 2355
		// (get) Token: 0x06002510 RID: 9488 RVA: 0x0009C6BC File Offset: 0x0009A8BC
		public float SeeingRange
		{
			get
			{
				return Campaign.Current.Models.MapVisibilityModel.GetPartySpottingRange(this, false).ResultNumber;
			}
		}

		// Token: 0x17000934 RID: 2356
		// (get) Token: 0x06002511 RID: 9489 RVA: 0x0009C6E7 File Offset: 0x0009A8E7
		public Settlement BesiegedSettlement
		{
			get
			{
				BesiegerCamp besiegerCamp = this.BesiegerCamp;
				if (besiegerCamp == null)
				{
					return null;
				}
				return besiegerCamp.SiegeEvent.BesiegedSettlement;
			}
		}

		// Token: 0x06002512 RID: 9490 RVA: 0x0009C700 File Offset: 0x0009A900
		public float GetTotalStrengthWithFollowers(bool includeNonAttachedArmyMembers = true)
		{
			MobileParty mobileParty = ((this.DefaultBehavior == AiBehavior.EscortParty) ? this.TargetParty : this);
			float num = mobileParty.Party.TotalStrength;
			if (mobileParty.Army != null && mobileParty == mobileParty.Army.LeaderParty)
			{
				foreach (MobileParty mobileParty2 in mobileParty.Army.Parties)
				{
					if (mobileParty2.Army.LeaderParty != mobileParty2 && (mobileParty2.AttachedTo != null || includeNonAttachedArmyMembers))
					{
						num += mobileParty2.Party.TotalStrength;
					}
				}
			}
			return num;
		}

		// Token: 0x06002513 RID: 9491 RVA: 0x0009C7B4 File Offset: 0x0009A9B4
		private void FillPartyStacks(PartyTemplateObject pt, int troopNumberLimit = -1)
		{
			if (this.IsBandit)
			{
				float playerProgress = Campaign.Current.PlayerProgress;
				float num = 0.4f + 0.8f * playerProgress;
				int num2 = MBRandom.RandomInt(2);
				float num3 = ((num2 == 0) ? MBRandom.RandomFloat : (MBRandom.RandomFloat * MBRandom.RandomFloat * MBRandom.RandomFloat * 4f));
				float num4 = ((num2 == 0) ? (num3 * 0.8f + 0.2f) : (1f + num3));
				float randomFloat = MBRandom.RandomFloat;
				float randomFloat2 = MBRandom.RandomFloat;
				float randomFloat3 = MBRandom.RandomFloat;
				float num5 = ((pt.Stacks.Count > 0) ? ((float)pt.Stacks[0].MinValue + num * num4 * randomFloat * (float)(pt.Stacks[0].MaxValue - pt.Stacks[0].MinValue)) : 0f);
				float num6 = ((pt.Stacks.Count > 1) ? ((float)pt.Stacks[1].MinValue + num * num4 * randomFloat2 * (float)(pt.Stacks[1].MaxValue - pt.Stacks[1].MinValue)) : 0f);
				float num7 = ((pt.Stacks.Count > 2) ? ((float)pt.Stacks[2].MinValue + num * num4 * randomFloat3 * (float)(pt.Stacks[2].MaxValue - pt.Stacks[2].MinValue)) : 0f);
				this.AddElementToMemberRoster(pt.Stacks[0].Character, MBRandom.RoundRandomized(num5), false);
				if (pt.Stacks.Count > 1)
				{
					this.AddElementToMemberRoster(pt.Stacks[1].Character, MBRandom.RoundRandomized(num6), false);
				}
				if (pt.Stacks.Count > 2)
				{
					this.AddElementToMemberRoster(pt.Stacks[2].Character, MBRandom.RoundRandomized(num7), false);
					return;
				}
			}
			else
			{
				if (troopNumberLimit < 0)
				{
					float playerProgress2 = Campaign.Current.PlayerProgress;
					for (int i = 0; i < pt.Stacks.Count; i++)
					{
						int num8 = (int)(playerProgress2 * (float)(pt.Stacks[i].MaxValue - pt.Stacks[i].MinValue)) + pt.Stacks[i].MinValue;
						CharacterObject character = pt.Stacks[i].Character;
						this.AddElementToMemberRoster(character, num8, false);
					}
					return;
				}
				for (int j = 0; j < troopNumberLimit; j++)
				{
					int num9 = -1;
					float num10 = 0f;
					for (int k = 0; k < pt.Stacks.Count; k++)
					{
						num10 += ((this.IsGarrison && pt.Stacks[k].Character.IsRanged) ? 6f : ((this.IsGarrison && !pt.Stacks[k].Character.IsMounted) ? 2f : 1f)) * ((float)(pt.Stacks[k].MaxValue + pt.Stacks[k].MinValue) / 2f);
					}
					float num11 = MBRandom.RandomFloat * num10;
					for (int l = 0; l < pt.Stacks.Count; l++)
					{
						num11 -= ((this.IsGarrison && pt.Stacks[l].Character.IsRanged) ? 6f : ((this.IsGarrison && !pt.Stacks[l].Character.IsMounted) ? 2f : 1f)) * ((float)(pt.Stacks[l].MaxValue + pt.Stacks[l].MinValue) / 2f);
						if (num11 < 0f)
						{
							num9 = l;
							break;
						}
					}
					if (num9 < 0)
					{
						num9 = 0;
					}
					CharacterObject character2 = pt.Stacks[num9].Character;
					this.AddElementToMemberRoster(character2, 1, false);
				}
				bool isVillager = this.IsVillager;
			}
		}

		// Token: 0x06002514 RID: 9492 RVA: 0x0009CBFC File Offset: 0x0009ADFC
		private void OnPartyJoinedSiegeInternal()
		{
			this._besiegerCamp.AddSiegePartyInternal(this);
			this._besiegerCamp.SetSiegeCampPartyPosition(this);
		}

		// Token: 0x06002515 RID: 9493 RVA: 0x0009CC16 File Offset: 0x0009AE16
		private void OnPartyLeftSiegeInternal()
		{
			this._besiegerCamp.RemoveSiegePartyInternal(this);
			this.EventPositionAdder = Vec2.Zero;
			this._errorPosition = Vec2.Zero;
		}

		// Token: 0x06002516 RID: 9494 RVA: 0x0009CC3C File Offset: 0x0009AE3C
		public bool HasPerk(PerkObject perk, bool checkSecondaryRole = false)
		{
			switch (checkSecondaryRole ? perk.SecondaryRole : perk.PrimaryRole)
			{
			case SkillEffect.PerkRole.ClanLeader:
				if (this.LeaderHero != null)
				{
					Clan clan = this.LeaderHero.Clan;
					bool? flag;
					if (clan == null)
					{
						flag = null;
					}
					else
					{
						Hero leader = clan.Leader;
						flag = ((leader != null) ? new bool?(leader.GetPerkValue(perk)) : null);
					}
					return flag ?? false;
				}
				return false;
			case SkillEffect.PerkRole.ArmyCommander:
			{
				Army army = this.Army;
				bool? flag2;
				if (army == null)
				{
					flag2 = null;
				}
				else
				{
					MobileParty leaderParty = army.LeaderParty;
					if (leaderParty == null)
					{
						flag2 = null;
					}
					else
					{
						Hero leaderHero = leaderParty.LeaderHero;
						flag2 = ((leaderHero != null) ? new bool?(leaderHero.GetPerkValue(perk)) : null);
					}
				}
				return flag2 ?? false;
			}
			case SkillEffect.PerkRole.PartyLeader:
			{
				Hero leaderHero2 = this.LeaderHero;
				return leaderHero2 != null && leaderHero2.GetPerkValue(perk);
			}
			case SkillEffect.PerkRole.Surgeon:
			{
				Hero effectiveSurgeon = this.EffectiveSurgeon;
				return effectiveSurgeon != null && effectiveSurgeon.GetPerkValue(perk);
			}
			case SkillEffect.PerkRole.Engineer:
			{
				Hero effectiveEngineer = this.EffectiveEngineer;
				return effectiveEngineer != null && effectiveEngineer.GetPerkValue(perk);
			}
			case SkillEffect.PerkRole.Scout:
			{
				Hero effectiveScout = this.EffectiveScout;
				return effectiveScout != null && effectiveScout.GetPerkValue(perk);
			}
			case SkillEffect.PerkRole.Quartermaster:
			{
				Hero effectiveQuartermaster = this.EffectiveQuartermaster;
				return effectiveQuartermaster != null && effectiveQuartermaster.GetPerkValue(perk);
			}
			case SkillEffect.PerkRole.PartyMember:
				foreach (TroopRosterElement troopRosterElement in this.MemberRoster.GetTroopRoster())
				{
					if (troopRosterElement.Character.IsHero && troopRosterElement.Character.HeroObject.GetPerkValue(perk))
					{
						return true;
					}
				}
				return false;
			case SkillEffect.PerkRole.Personal:
			{
				Debug.FailedAssert("personal perk is called in party", "C:\\Develop\\MB3\\Source\\Bannerlord\\TaleWorlds.CampaignSystem\\Party\\MobileParty.cs", "HasPerk", 2217);
				Hero leaderHero3 = this.LeaderHero;
				return leaderHero3 != null && leaderHero3.GetPerkValue(perk);
			}
			}
			return false;
		}

		// Token: 0x17000935 RID: 2357
		// (get) Token: 0x06002517 RID: 9495 RVA: 0x0009CE48 File Offset: 0x0009B048
		public bool IsEngaging
		{
			get
			{
				return this.DefaultBehavior == AiBehavior.EngageParty || this.ShortTermBehavior == AiBehavior.EngageParty;
			}
		}

		// Token: 0x06002518 RID: 9496 RVA: 0x0009CE5E File Offset: 0x0009B05E
		public SkillEffect.PerkRole GetHeroPerkRole(Hero hero)
		{
			if (this.Engineer == hero)
			{
				return SkillEffect.PerkRole.Engineer;
			}
			if (this.Quartermaster == hero)
			{
				return SkillEffect.PerkRole.Quartermaster;
			}
			if (this.Surgeon == hero)
			{
				return SkillEffect.PerkRole.Surgeon;
			}
			if (this.Scout == hero)
			{
				return SkillEffect.PerkRole.Scout;
			}
			return SkillEffect.PerkRole.None;
		}

		// Token: 0x06002519 RID: 9497 RVA: 0x0009CE90 File Offset: 0x0009B090
		public void RemoveHeroPerkRole(Hero hero)
		{
			if (this.Engineer == hero)
			{
				this.Engineer = null;
			}
			if (this.Quartermaster == hero)
			{
				this.Quartermaster = null;
			}
			if (this.Surgeon == hero)
			{
				this.Surgeon = null;
			}
			if (this.Scout == hero)
			{
				this.Scout = null;
			}
		}

		// Token: 0x0600251A RID: 9498 RVA: 0x0009CEE0 File Offset: 0x0009B0E0
		public Hero GetRoleHolder(SkillEffect.PerkRole perkRole)
		{
			switch (perkRole)
			{
			case SkillEffect.PerkRole.PartyLeader:
				return this.LeaderHero;
			case SkillEffect.PerkRole.Surgeon:
				return this.Surgeon;
			case SkillEffect.PerkRole.Engineer:
				return this.Engineer;
			case SkillEffect.PerkRole.Scout:
				return this.Scout;
			case SkillEffect.PerkRole.Quartermaster:
				return this.Quartermaster;
			}
			return null;
		}

		// Token: 0x0600251B RID: 9499 RVA: 0x0009CF34 File Offset: 0x0009B134
		public Hero GetEffectiveRoleHolder(SkillEffect.PerkRole perkRole)
		{
			switch (perkRole)
			{
			case SkillEffect.PerkRole.PartyLeader:
				return this.LeaderHero;
			case SkillEffect.PerkRole.Surgeon:
				return this.EffectiveSurgeon;
			case SkillEffect.PerkRole.Engineer:
				return this.EffectiveEngineer;
			case SkillEffect.PerkRole.Scout:
				return this.EffectiveScout;
			case SkillEffect.PerkRole.Quartermaster:
				return this.EffectiveQuartermaster;
			}
			return null;
		}

		// Token: 0x17000936 RID: 2358
		// (get) Token: 0x0600251C RID: 9500 RVA: 0x0009CF87 File Offset: 0x0009B187
		internal bool IsCurrentlyEngagingSettlement
		{
			get
			{
				return this.ShortTermBehavior == AiBehavior.GoToSettlement || this.ShortTermBehavior == AiBehavior.RaidSettlement || this.ShortTermBehavior == AiBehavior.AssaultSettlement;
			}
		}

		// Token: 0x0600251D RID: 9501 RVA: 0x0009CFA8 File Offset: 0x0009B1A8
		public int GetNumDaysForFoodToLast()
		{
			int num = this.ItemRoster.TotalFood;
			num *= 100;
			if (this == MobileParty.MainParty)
			{
				num += this.Party.RemainingFoodPercentage;
			}
			return (int)((float)num / (100f * -this.FoodChange));
		}

		// Token: 0x17000937 RID: 2359
		// (get) Token: 0x0600251E RID: 9502 RVA: 0x0009CFED File Offset: 0x0009B1ED
		internal bool IsCurrentlyEngagingParty
		{
			get
			{
				return this.ShortTermBehavior == AiBehavior.EngageParty;
			}
		}

		// Token: 0x0600251F RID: 9503 RVA: 0x0009CFF8 File Offset: 0x0009B1F8
		public Vec3 GetPosition()
		{
			return this.GetLogicalPosition();
		}

		// Token: 0x17000938 RID: 2360
		// (get) Token: 0x06002520 RID: 9504 RVA: 0x0009D000 File Offset: 0x0009B200
		public bool IsCurrentlyGoingToSettlement
		{
			get
			{
				return this.ShortTermBehavior == AiBehavior.GoToSettlement;
			}
		}

		// Token: 0x06002521 RID: 9505 RVA: 0x0009D00C File Offset: 0x0009B20C
		public float GetTrackDistanceToMainAgent()
		{
			return this.GetPosition().Distance(Hero.MainHero.GetPosition());
		}

		// Token: 0x17000939 RID: 2361
		// (get) Token: 0x06002522 RID: 9506 RVA: 0x0009D034 File Offset: 0x0009B234
		public float PartySizeRatio
		{
			get
			{
				int versionNo = this.Party.MemberRoster.VersionNo;
				float num = this._cachedPartySizeRatio;
				if (this._partySizeRatioLastCheckVersion != versionNo || this == MobileParty.MainParty)
				{
					this._partySizeRatioLastCheckVersion = versionNo;
					this._cachedPartySizeRatio = (float)this.Party.NumberOfAllMembers / (float)this.Party.PartySizeLimit;
					num = this._cachedPartySizeRatio;
				}
				return num;
			}
		}

		// Token: 0x1700093A RID: 2362
		// (get) Token: 0x06002523 RID: 9507 RVA: 0x0009D098 File Offset: 0x0009B298
		public int LimitedPartySize
		{
			get
			{
				if (!this.HasLimitedWage())
				{
					return this.Party.PartySizeLimit;
				}
				int paymentLimit = this.Party.MobileParty.PaymentLimit;
				if (this._latestUsedPaymentRatio != paymentLimit || this == MobileParty.MainParty)
				{
					this._latestUsedPaymentRatio = paymentLimit;
					int num = Math.Min((this.LeaderHero != null && this.Party.Owner != null && this.Party.Owner.Clan != null && this.LeaderHero != this.Party.Owner.Clan.Leader) ? this.LeaderHero.CharacterObject.TroopWage : 0, this.TotalWage);
					int num2 = (int)((float)(this.PaymentLimit - num) / Campaign.Current.AverageWage) + 1;
					int num3 = MathF.Max(1, MathF.Min(num2, this.Party.PartySizeLimit));
					this._cachedPartySizeLimit = num3;
					return num3;
				}
				return this._cachedPartySizeLimit;
			}
		}

		// Token: 0x06002524 RID: 9508 RVA: 0x0009D18C File Offset: 0x0009B38C
		public bool CheckTracked(BasicCharacterObject basicCharacter)
		{
			return this.MemberRoster.GetTroopRoster().Any((TroopRosterElement t) => t.Character == basicCharacter) || this.PrisonRoster.GetTroopRoster().Any((TroopRosterElement t) => t.Character == basicCharacter);
		}

		// Token: 0x1700093B RID: 2363
		// (get) Token: 0x06002525 RID: 9509 RVA: 0x0009D1E2 File Offset: 0x0009B3E2
		public Vec2 VisualPosition2DWithoutError
		{
			get
			{
				return this.Position2D + this.EventPositionAdder + this.ArmyPositionAdder;
			}
		}

		// Token: 0x06002526 RID: 9510 RVA: 0x0009D200 File Offset: 0x0009B400
		private Settlement DetermineRelatedBesiegedSettlementWhileDestroyingParty()
		{
			Settlement settlement = this.BesiegedSettlement;
			if (settlement == null)
			{
				settlement = ((this.ShortTermBehavior == AiBehavior.AssaultSettlement) ? this.ShortTermTargetSettlement : null);
			}
			if (settlement == null && (this.IsGarrison || this.IsMilitia) && this.CurrentSettlement != null)
			{
				MobileParty lastAttackerParty = this.CurrentSettlement.LastAttackerParty;
				MapEvent mapEvent = ((lastAttackerParty != null) ? lastAttackerParty.MapEvent : null);
				if (mapEvent != null && (mapEvent.IsSiegeAssault || mapEvent.IsSiegeOutside || mapEvent.IsSallyOut) && mapEvent.DefeatedSide != BattleSideEnum.None && mapEvent.State == MapEventState.WaitingRemoval)
				{
					settlement = this.CurrentSettlement;
				}
			}
			return settlement;
		}

		// Token: 0x06002527 RID: 9511 RVA: 0x0009D294 File Offset: 0x0009B494
		public void RemoveParty()
		{
			this.IsActive = false;
			this.IsVisible = false;
			Settlement settlement = this.DetermineRelatedBesiegedSettlementWhileDestroyingParty();
			Campaign campaign = Campaign.Current;
			IPartyVisual visuals = this.Party.Visuals;
			if (visuals != null)
			{
				visuals.OnPartyRemoved();
			}
			this.AttachedTo = null;
			this.BesiegerCamp = null;
			this.ReleaseHeroPrisoners();
			this.ItemRoster.Clear();
			this.MemberRoster.Reset();
			this.PrisonRoster.Reset();
			Campaign.Current.MobilePartyLocator.RemoveLocatable(this);
			Campaign.Current.VisualTrackerManager.RemoveTrackedObject(this, true);
			CampaignEventDispatcher.Instance.OnPartyRemoved(this.Party);
			GC.SuppressFinalize(this.Party);
			foreach (MobileParty mobileParty in campaign.MobileParties)
			{
				bool flag = mobileParty.Ai.AiBehaviorPartyBase == this.Party || (mobileParty.TargetSettlement != null && mobileParty.TargetSettlement == settlement) || (mobileParty.ShortTermTargetSettlement != null && mobileParty.ShortTermTargetSettlement == settlement);
				if (mobileParty.TargetParty != null && mobileParty.TargetParty == this)
				{
					mobileParty.ResetTargetParty();
					flag = true;
				}
				if (flag && mobileParty.TargetSettlement != null && (mobileParty.MapEvent == null || mobileParty.MapEvent.IsFinalized) && mobileParty.DefaultBehavior == AiBehavior.GoToSettlement)
				{
					Settlement targetSettlement = mobileParty.TargetSettlement;
					mobileParty.Ai.SetMoveModeHold();
					mobileParty.Ai.SetNavigationModeHold();
					mobileParty.Ai.SetMoveGoToSettlement(targetSettlement);
					flag = false;
				}
				if (flag)
				{
					mobileParty.Ai.SetMoveModeHold();
					mobileParty.Ai.SetNavigationModeHold();
				}
			}
			this.OnRemoveParty();
			this._customHomeSettlement = null;
		}

		// Token: 0x1700093C RID: 2364
		// (get) Token: 0x06002528 RID: 9512 RVA: 0x0009D458 File Offset: 0x0009B658
		public bool IsMoving
		{
			get
			{
				if (this.IsMainParty)
				{
					return !Campaign.Current.IsMainPartyWaiting;
				}
				return this.Position2D != this.TargetPosition || (this.MapEvent == null && this.BesiegedSettlement == null && this.CurrentSettlement == null && this.ShortTermBehavior > AiBehavior.Hold);
			}
		}

		// Token: 0x06002529 RID: 9513 RVA: 0x0009D4B4 File Offset: 0x0009B6B4
		private void ReleaseHeroPrisoners()
		{
			for (int i = this.PrisonRoster.Count - 1; i >= 0; i--)
			{
				if (this.PrisonRoster.GetElementNumber(i) > 0)
				{
					TroopRosterElement elementCopyAtIndex = this.PrisonRoster.GetElementCopyAtIndex(i);
					if (elementCopyAtIndex.Character.IsHero && !elementCopyAtIndex.Character.IsPlayerCharacter)
					{
						EndCaptivityAction.ApplyByReleasedByChoice(elementCopyAtIndex.Character.HeroObject, null);
					}
				}
			}
		}

		// Token: 0x1700093D RID: 2365
		// (get) Token: 0x0600252A RID: 9514 RVA: 0x0009D520 File Offset: 0x0009B720
		public bool ShouldBeIgnored
		{
			get
			{
				return this._ignoredUntilTime.IsFuture;
			}
		}

		// Token: 0x0600252B RID: 9515 RVA: 0x0009D530 File Offset: 0x0009B730
		private void CreateFigure(Vec2 position, float spawnRadius)
		{
			Vec2 accessiblePointNearPosition = Campaign.Current.MapSceneWrapper.GetAccessiblePointNearPosition(position, spawnRadius);
			this.Position2D = new Vec2(accessiblePointNearPosition.x, accessiblePointNearPosition.y);
			Vec2 vec = new Vec2(1f, 0f);
			float num = MBRandom.RandomFloat * 2f * 3.1415927f;
			vec.RotateCCW(num);
			this.Bearing = vec;
			this.Party.UpdateVisibilityAndInspected(0f, false);
			this.Party.Visuals.OnStartup(this.Party);
			this.StartUp();
		}

		// Token: 0x0600252C RID: 9516 RVA: 0x0009D5C5 File Offset: 0x0009B7C5
		internal void SendPartyToReachablePointAroundPosition(Vec2 centerPosition, float distanceLimit, float innerCenterMinimumDistanceLimit = 0f)
		{
			this.Ai.SetMoveGoToPoint(MobilePartyHelper.FindReachablePointAroundPosition(centerPosition, distanceLimit, innerCenterMinimumDistanceLimit));
		}

		// Token: 0x0600252D RID: 9517 RVA: 0x0009D5DC File Offset: 0x0009B7DC
		internal void TeleportPartyToSafePosition(float maxRadius = 3.3f, float minRadius = 3f)
		{
			for (int i = 0; i < 15; i++)
			{
				Vec2 vec = MobilePartyHelper.FindReachablePointAroundPosition(this.Position2D, maxRadius, minRadius);
				bool flag = true;
				LocatableSearchData<MobileParty> locatableSearchData = MobileParty.StartFindingLocatablesAroundPosition(vec, 1f);
				for (MobileParty mobileParty = MobileParty.FindNextLocatable(ref locatableSearchData); mobileParty != null; mobileParty = MobileParty.FindNextLocatable(ref locatableSearchData))
				{
					if (mobileParty.MapFaction.IsAtWarWith(this.MapFaction))
					{
						flag = false;
						break;
					}
				}
				if (flag)
				{
					this.Position2D = vec;
					return;
				}
			}
		}

		// Token: 0x1700093E RID: 2366
		// (get) Token: 0x0600252E RID: 9518 RVA: 0x0009D650 File Offset: 0x0009B850
		public float FoodChange
		{
			get
			{
				ExplainedNumber explainedNumber = Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyBaseFoodConsumptionf(this, false);
				return Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyFoodConsumptionf(this, explainedNumber).ResultNumber;
			}
		}

		// Token: 0x1700093F RID: 2367
		// (get) Token: 0x0600252F RID: 9519 RVA: 0x0009D694 File Offset: 0x0009B894
		public float BaseFoodChange
		{
			get
			{
				return Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyBaseFoodConsumptionf(this, false).ResultNumber;
			}
		}

		// Token: 0x17000940 RID: 2368
		// (get) Token: 0x06002530 RID: 9520 RVA: 0x0009D6C0 File Offset: 0x0009B8C0
		public ExplainedNumber FoodChangeExplained
		{
			get
			{
				ExplainedNumber explainedNumber = Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyBaseFoodConsumptionf(this, true);
				return Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyFoodConsumptionf(this, explainedNumber);
			}
		}

		// Token: 0x17000941 RID: 2369
		// (get) Token: 0x06002531 RID: 9521 RVA: 0x0009D6FC File Offset: 0x0009B8FC
		public float HealingRateForRegulars
		{
			get
			{
				return Campaign.Current.Models.PartyHealingModel.GetDailyHealingForRegulars(this, false).ResultNumber;
			}
		}

		// Token: 0x17000942 RID: 2370
		// (get) Token: 0x06002532 RID: 9522 RVA: 0x0009D727 File Offset: 0x0009B927
		public ExplainedNumber HealingRateForRegularsExplained
		{
			get
			{
				return Campaign.Current.Models.PartyHealingModel.GetDailyHealingForRegulars(this, true);
			}
		}

		// Token: 0x17000943 RID: 2371
		// (get) Token: 0x06002533 RID: 9523 RVA: 0x0009D740 File Offset: 0x0009B940
		public float HealingRateForHeroes
		{
			get
			{
				return Campaign.Current.Models.PartyHealingModel.GetDailyHealingHpForHeroes(this, false).ResultNumber;
			}
		}

		// Token: 0x17000944 RID: 2372
		// (get) Token: 0x06002534 RID: 9524 RVA: 0x0009D76B File Offset: 0x0009B96B
		public ExplainedNumber HealingRateForHeroesExplained
		{
			get
			{
				return Campaign.Current.Models.PartyHealingModel.GetDailyHealingHpForHeroes(this, true);
			}
		}

		// Token: 0x17000945 RID: 2373
		// (get) Token: 0x06002535 RID: 9525 RVA: 0x0009D783 File Offset: 0x0009B983
		public ExplainedNumber SeeingRangeExplanation
		{
			get
			{
				return Campaign.Current.Models.MapVisibilityModel.GetPartySpottingRange(this, true);
			}
		}

		// Token: 0x17000946 RID: 2374
		// (get) Token: 0x06002536 RID: 9526 RVA: 0x0009D79C File Offset: 0x0009B99C
		public int InventoryCapacity
		{
			get
			{
				return (int)Campaign.Current.Models.InventoryCapacityModel.CalculateInventoryCapacity(this, false, 0, 0, 0, false).ResultNumber;
			}
		}

		// Token: 0x17000947 RID: 2375
		// (get) Token: 0x06002537 RID: 9527 RVA: 0x0009D7CC File Offset: 0x0009B9CC
		public ExplainedNumber InventoryCapacityExplainedNumber
		{
			get
			{
				return Campaign.Current.Models.InventoryCapacityModel.CalculateInventoryCapacity(this, true, 0, 0, 0, false);
			}
		}

		// Token: 0x17000948 RID: 2376
		// (get) Token: 0x06002538 RID: 9528 RVA: 0x0009D7E8 File Offset: 0x0009B9E8
		// (set) Token: 0x06002539 RID: 9529 RVA: 0x0009D7F5 File Offset: 0x0009B9F5
		public MapEventSide MapEventSide
		{
			get
			{
				return this.Party.MapEventSide;
			}
			set
			{
				this.Party.MapEventSide = value;
			}
		}

		// Token: 0x0600253A RID: 9530 RVA: 0x0009D803 File Offset: 0x0009BA03
		public static LocatableSearchData<MobileParty> StartFindingLocatablesAroundPosition(Vec2 position, float radius)
		{
			return Campaign.Current.MobilePartyLocator.StartFindingLocatablesAroundPosition(position, radius);
		}

		// Token: 0x0600253B RID: 9531 RVA: 0x0009D816 File Offset: 0x0009BA16
		public static MobileParty FindNextLocatable(ref LocatableSearchData<MobileParty> data)
		{
			return Campaign.Current.MobilePartyLocator.FindNextLocatable(ref data);
		}

		// Token: 0x0600253C RID: 9532 RVA: 0x0009D828 File Offset: 0x0009BA28
		internal void OnHeroAdded(Hero hero)
		{
			hero.OnAddedToParty(this);
		}

		// Token: 0x0600253D RID: 9533 RVA: 0x0009D831 File Offset: 0x0009BA31
		internal void OnHeroRemoved(Hero hero)
		{
			hero.OnRemovedFromParty(this);
		}

		// Token: 0x0600253E RID: 9534 RVA: 0x0009D83C File Offset: 0x0009BA3C
		internal void CheckExitingSettlementParallel(ref int exitingPartyCount, ref MobileParty[] exitingPartyList)
		{
			if (!this.Ai.IsDisabled && this.CurrentSettlement != null && (!this.IsCurrentlyGoingToSettlement || this.ShortTermTargetSettlement != this.CurrentSettlement) && !this.IsMainParty && (this.Army == null || this.AttachedTo == null || this.Army.LeaderParty == this))
			{
				int num = Interlocked.Increment(ref exitingPartyCount);
				exitingPartyList[num] = this;
			}
		}

		// Token: 0x0600253F RID: 9535 RVA: 0x0009D8A8 File Offset: 0x0009BAA8
		public bool ComputeIsWaiting()
		{
			return (2f * this.Position2D - this.TargetPosition - this.Ai.NextTargetPosition).LengthSquared < 1E-05f || this.DefaultBehavior == AiBehavior.Hold || ((this.DefaultBehavior == AiBehavior.EngageParty || this.DefaultBehavior == AiBehavior.EscortParty) && this.Ai.AiBehaviorPartyBase != null && this.Ai.AiBehaviorPartyBase.IsValid && this.Ai.AiBehaviorPartyBase.IsActive && this.Ai.AiBehaviorPartyBase.IsMobile && this.Ai.AiBehaviorPartyBase.MobileParty.CurrentSettlement != null);
		}

		// Token: 0x17000949 RID: 2377
		// (get) Token: 0x06002540 RID: 9536 RVA: 0x0009D969 File Offset: 0x0009BB69
		bool IMapEntity.ShowCircleAroundEntity
		{
			get
			{
				return this.CurrentSettlement == null;
			}
		}

		// Token: 0x06002541 RID: 9537 RVA: 0x0009D974 File Offset: 0x0009BB74
		void IMapEntity.OnOpenEncyclopedia()
		{
			if (this.IsLordParty && this.LeaderHero != null)
			{
				Campaign.Current.EncyclopediaManager.GoToLink(this.LeaderHero.EncyclopediaLink);
			}
		}

		// Token: 0x06002542 RID: 9538 RVA: 0x0009D9A0 File Offset: 0x0009BBA0
		bool IMapEntity.OnMapClick(bool followModifierUsed)
		{
			if (this.IsMainParty)
			{
				MobileParty.MainParty.Ai.SetMoveModeHold();
			}
			else if (followModifierUsed)
			{
				MobileParty.MainParty.Ai.SetMoveEscortParty(this);
			}
			else
			{
				MobileParty.MainParty.Ai.SetMoveEngageParty(this);
			}
			return true;
		}

		// Token: 0x06002543 RID: 9539 RVA: 0x0009D9EC File Offset: 0x0009BBEC
		void IMapEntity.OnHover()
		{
			Army army = this.Army;
			if (((army != null) ? army.LeaderParty : null) == this)
			{
				InformationManager.ShowTooltip(typeof(Army), new object[] { this.Army, false, true });
				return;
			}
			InformationManager.ShowTooltip(typeof(MobileParty), new object[] { this, false, true });
		}

		// Token: 0x06002544 RID: 9540 RVA: 0x0009DA6A File Offset: 0x0009BC6A
		bool IMapEntity.IsEnemyOf(IFaction faction)
		{
			return FactionManager.IsAtWarAgainstFaction(this.MapFaction, faction);
		}

		// Token: 0x06002545 RID: 9541 RVA: 0x0009DA78 File Offset: 0x0009BC78
		bool IMapEntity.IsAllyOf(IFaction faction)
		{
			return FactionManager.IsAlliedWithFaction(this.MapFaction, faction);
		}

		// Token: 0x06002546 RID: 9542 RVA: 0x0009DA86 File Offset: 0x0009BC86
		public void GetMountAndHarnessVisualIdsForPartyIcon(out string mountStringId, out string harnessStringId)
		{
			mountStringId = "";
			harnessStringId = "";
			PartyComponent partyComponent = this._partyComponent;
			if (partyComponent == null)
			{
				return;
			}
			partyComponent.GetMountAndHarnessVisualIdsForPartyIcon(this.Party, out mountStringId, out harnessStringId);
		}

		// Token: 0x1700094A RID: 2378
		// (get) Token: 0x06002547 RID: 9543 RVA: 0x0009DAAE File Offset: 0x0009BCAE
		Vec2 IMapEntity.InteractionPosition
		{
			get
			{
				return this.Position2D;
			}
		}

		// Token: 0x1700094B RID: 2379
		// (get) Token: 0x06002548 RID: 9544 RVA: 0x0009DAB6 File Offset: 0x0009BCB6
		bool IMapEntity.IsMobileEntity
		{
			get
			{
				return true;
			}
		}

		// Token: 0x1700094C RID: 2380
		// (get) Token: 0x06002549 RID: 9545 RVA: 0x0009DAB9 File Offset: 0x0009BCB9
		IMapEntity IMapEntity.AttachedEntity
		{
			get
			{
				return this.AttachedTo;
			}
		}

		// Token: 0x1700094D RID: 2381
		// (get) Token: 0x0600254A RID: 9546 RVA: 0x0009DAC1 File Offset: 0x0009BCC1
		IPartyVisual IMapEntity.PartyVisual
		{
			get
			{
				return this.Party.Visuals;
			}
		}

		// Token: 0x0600254B RID: 9547 RVA: 0x0009DACE File Offset: 0x0009BCCE
		bool IMapEntity.IsMainEntity()
		{
			return this.IsMainParty;
		}

		// Token: 0x0600254C RID: 9548 RVA: 0x0009DAD8 File Offset: 0x0009BCD8
		void IMapEntity.OnPartyInteraction(MobileParty engagingParty)
		{
			MobileParty mobileParty = this;
			if (mobileParty.AttachedTo != null && engagingParty != mobileParty.AttachedTo)
			{
				mobileParty = mobileParty.AttachedTo;
			}
			bool flag = false;
			if (mobileParty.CurrentSettlement != null)
			{
				if (mobileParty.MapEvent != null)
				{
					flag = mobileParty.MapEvent.MapEventSettlement == mobileParty.CurrentSettlement && (mobileParty.MapEvent.AttackerSide.LeaderParty.MapFaction == engagingParty.MapFaction || mobileParty.MapEvent.DefenderSide.LeaderParty.MapFaction == engagingParty.MapFaction);
				}
			}
			else
			{
				flag = engagingParty != MobileParty.MainParty || !mobileParty.IsEngaging || mobileParty.ShortTermTargetParty != MobileParty.MainParty;
			}
			if (flag)
			{
				if (engagingParty == MobileParty.MainParty)
				{
					MapState mapState = Game.Current.GameStateManager.ActiveState as MapState;
					if (mapState != null)
					{
						mapState.OnMainPartyEncounter();
					}
				}
				EncounterManager.StartPartyEncounter(engagingParty.Party, mobileParty.Party);
			}
		}

		// Token: 0x0600254D RID: 9549 RVA: 0x0009DBC8 File Offset: 0x0009BDC8
		public void InitializePartyTrade(int initialGold)
		{
			this.IsPartyTradeActive = true;
			this.PartyTradeGold = initialGold;
		}

		// Token: 0x0600254E RID: 9550 RVA: 0x0009DBD8 File Offset: 0x0009BDD8
		public void AddTaxGold(int amount)
		{
			this.PartyTradeTaxGold += amount;
		}

		// Token: 0x0600254F RID: 9551 RVA: 0x0009DBE8 File Offset: 0x0009BDE8
		public static MobileParty CreateParty(string stringId, PartyComponent component, PartyComponent.OnPartyComponentCreatedDelegate delegateFunction = null)
		{
			stringId = Campaign.Current.CampaignObjectManager.FindNextUniqueStringId<MobileParty>(stringId);
			MobileParty mobileParty = new MobileParty();
			mobileParty.StringId = stringId;
			mobileParty._partyComponent = component;
			mobileParty.UpdatePartyComponentFlags();
			if (component != null)
			{
				component.SetMobilePartyInternal(mobileParty);
			}
			if (delegateFunction != null)
			{
				delegateFunction(mobileParty);
			}
			PartyComponent partyComponent = mobileParty.PartyComponent;
			if (partyComponent != null)
			{
				partyComponent.Initialize(mobileParty);
			}
			Campaign.Current.CampaignObjectManager.AddMobileParty(mobileParty);
			CampaignEventDispatcher.Instance.OnMobilePartyCreated(mobileParty);
			return mobileParty;
		}

		// Token: 0x1700094E RID: 2382
		// (get) Token: 0x06002550 RID: 9552 RVA: 0x0009DC63 File Offset: 0x0009BE63
		public CaravanPartyComponent CaravanPartyComponent
		{
			get
			{
				return this._partyComponent as CaravanPartyComponent;
			}
		}

		// Token: 0x1700094F RID: 2383
		// (get) Token: 0x06002551 RID: 9553 RVA: 0x0009DC70 File Offset: 0x0009BE70
		public WarPartyComponent WarPartyComponent
		{
			get
			{
				return this._partyComponent as WarPartyComponent;
			}
		}

		// Token: 0x17000950 RID: 2384
		// (get) Token: 0x06002552 RID: 9554 RVA: 0x0009DC7D File Offset: 0x0009BE7D
		public BanditPartyComponent BanditPartyComponent
		{
			get
			{
				return this._partyComponent as BanditPartyComponent;
			}
		}

		// Token: 0x17000951 RID: 2385
		// (get) Token: 0x06002553 RID: 9555 RVA: 0x0009DC8A File Offset: 0x0009BE8A
		public LordPartyComponent LordPartyComponent
		{
			get
			{
				return this._partyComponent as LordPartyComponent;
			}
		}

		// Token: 0x17000952 RID: 2386
		// (get) Token: 0x06002554 RID: 9556 RVA: 0x0009DC97 File Offset: 0x0009BE97
		// (set) Token: 0x06002555 RID: 9557 RVA: 0x0009DCA0 File Offset: 0x0009BEA0
		public PartyComponent PartyComponent
		{
			get
			{
				return this._partyComponent;
			}
			set
			{
				if (this._partyComponent != value)
				{
					if (this._partyComponent != null)
					{
						this._partyComponent.Finish();
					}
					Campaign.Current.CampaignObjectManager.BeforePartyComponentChanged(this);
					this._partyComponent = value;
					this.UpdatePartyComponentFlags();
					Campaign.Current.CampaignObjectManager.AfterPartyComponentChanged(this);
					if (this._partyComponent != null)
					{
						this._partyComponent.Initialize(this);
					}
				}
			}
		}

		// Token: 0x17000953 RID: 2387
		// (get) Token: 0x06002556 RID: 9558 RVA: 0x0009DD0A File Offset: 0x0009BF0A
		// (set) Token: 0x06002557 RID: 9559 RVA: 0x0009DD12 File Offset: 0x0009BF12
		[CachedData]
		public bool IsMilitia { get; private set; }

		// Token: 0x17000954 RID: 2388
		// (get) Token: 0x06002558 RID: 9560 RVA: 0x0009DD1B File Offset: 0x0009BF1B
		// (set) Token: 0x06002559 RID: 9561 RVA: 0x0009DD23 File Offset: 0x0009BF23
		[CachedData]
		public bool IsLordParty { get; private set; }

		// Token: 0x0600255A RID: 9562 RVA: 0x0009DD2C File Offset: 0x0009BF2C
		public void UpdatePartyComponentFlags()
		{
			this.IsLordParty = this._partyComponent is LordPartyComponent;
			this.IsVillager = this._partyComponent is VillagerPartyComponent;
			this.IsMilitia = this._partyComponent is MilitiaPartyComponent;
			this.IsCaravan = this._partyComponent is CaravanPartyComponent;
			this.IsGarrison = this._partyComponent is GarrisonPartyComponent;
			this.IsCustomParty = this._partyComponent is CustomPartyComponent;
			this.IsBandit = this._partyComponent is BanditPartyComponent;
		}

		// Token: 0x17000955 RID: 2389
		// (get) Token: 0x0600255B RID: 9563 RVA: 0x0009DDC5 File Offset: 0x0009BFC5
		// (set) Token: 0x0600255C RID: 9564 RVA: 0x0009DDCD File Offset: 0x0009BFCD
		[CachedData]
		public bool IsVillager { get; private set; }

		// Token: 0x17000956 RID: 2390
		// (get) Token: 0x0600255D RID: 9565 RVA: 0x0009DDD6 File Offset: 0x0009BFD6
		// (set) Token: 0x0600255E RID: 9566 RVA: 0x0009DDDE File Offset: 0x0009BFDE
		[CachedData]
		public bool IsCaravan { get; private set; }

		// Token: 0x17000957 RID: 2391
		// (get) Token: 0x0600255F RID: 9567 RVA: 0x0009DDE7 File Offset: 0x0009BFE7
		// (set) Token: 0x06002560 RID: 9568 RVA: 0x0009DDEF File Offset: 0x0009BFEF
		[CachedData]
		public bool IsGarrison { get; private set; }

		// Token: 0x17000958 RID: 2392
		// (get) Token: 0x06002561 RID: 9569 RVA: 0x0009DDF8 File Offset: 0x0009BFF8
		// (set) Token: 0x06002562 RID: 9570 RVA: 0x0009DE00 File Offset: 0x0009C000
		[CachedData]
		public bool IsCustomParty { get; private set; }

		// Token: 0x17000959 RID: 2393
		// (get) Token: 0x06002563 RID: 9571 RVA: 0x0009DE09 File Offset: 0x0009C009
		// (set) Token: 0x06002564 RID: 9572 RVA: 0x0009DE11 File Offset: 0x0009C011
		[CachedData]
		public bool IsBandit { get; private set; }

		// Token: 0x1700095A RID: 2394
		// (get) Token: 0x06002565 RID: 9573 RVA: 0x0009DE1A File Offset: 0x0009C01A
		public bool IsBanditBossParty
		{
			get
			{
				return this.IsBandit && this.BanditPartyComponent.IsBossParty;
			}
		}

		// Token: 0x04000B12 RID: 2834
		public const int DefaultPartyTradeInitialGold = 5000;

		// Token: 0x04000B13 RID: 2835
		public const int ClanRoleAssignmentMinimumSkillValue = 0;

		// Token: 0x04000B15 RID: 2837
		[SaveableField(1001)]
		private Settlement _currentSettlement;

		// Token: 0x04000B18 RID: 2840
		[CachedData]
		private MBList<MobileParty> _attachedParties;

		// Token: 0x04000B19 RID: 2841
		[SaveableField(1046)]
		private MobileParty _attachedTo;

		// Token: 0x04000B1B RID: 2843
		[SaveableField(1006)]
		public float HasUnpaidWages;

		// Token: 0x04000B1D RID: 2845
		[SaveableField(1060)]
		private Vec2 _eventPositionAdder;

		// Token: 0x04000B1F RID: 2847
		[SaveableField(1100)]
		private Vec2 _position2D;

		// Token: 0x04000B24 RID: 2852
		[SaveableField(1024)]
		private bool _isVisible;

		// Token: 0x04000B25 RID: 2853
		[CachedData]
		internal float _lastCalculatedSpeed = 1f;

		// Token: 0x04000B26 RID: 2854
		[SaveableField(1025)]
		private bool _isInspected;

		// Token: 0x04000B27 RID: 2855
		[SaveableField(1955)]
		private CampaignTime _disorganizedUntilTime;

		// Token: 0x04000B28 RID: 2856
		[CachedData]
		private int _partyPureSpeedLastCheckVersion = -1;

		// Token: 0x04000B29 RID: 2857
		[CachedData]
		private bool _partyLastCheckIsPrisoner;

		// Token: 0x04000B2A RID: 2858
		[CachedData]
		private ExplainedNumber _lastCalculatedBaseSpeedExplained;

		// Token: 0x04000B2C RID: 2860
		[CachedData]
		private bool _partyLastCheckAtNight;

		// Token: 0x04000B2D RID: 2861
		[CachedData]
		private int _itemRosterVersionNo = -1;

		// Token: 0x04000B2E RID: 2862
		[CachedData]
		private int _partySizeRatioLastCheckVersion = -1;

		// Token: 0x04000B2F RID: 2863
		[CachedData]
		private int _latestUsedPaymentRatio = -1;

		// Token: 0x04000B30 RID: 2864
		[CachedData]
		private float _cachedPartySizeRatio = 1f;

		// Token: 0x04000B31 RID: 2865
		[CachedData]
		private int _cachedPartySizeLimit;

		// Token: 0x04000B32 RID: 2866
		[SaveableField(1059)]
		private BesiegerCamp _besiegerCamp;

		// Token: 0x04000B33 RID: 2867
		[SaveableField(1048)]
		private MobileParty _targetParty;

		// Token: 0x04000B34 RID: 2868
		[SaveableField(1049)]
		private Settlement _targetSettlement;

		// Token: 0x04000B35 RID: 2869
		[SaveableField(1053)]
		private Vec2 _targetPosition;

		// Token: 0x04000B36 RID: 2870
		private int _doNotAttackMainParty;

		// Token: 0x04000B37 RID: 2871
		[SaveableField(1034)]
		private Settlement _customHomeSettlement;

		// Token: 0x04000B38 RID: 2872
		[SaveableField(1035)]
		private Army _army;

		// Token: 0x04000B39 RID: 2873
		[CachedData]
		private bool _isDisorganized;

		// Token: 0x04000B3A RID: 2874
		[SaveableField(1959)]
		private bool _isCurrentlyUsedByAQuest;

		// Token: 0x04000B3D RID: 2877
		[SaveableField(1956)]
		private int _partyTradeGold;

		// Token: 0x04000B3F RID: 2879
		[SaveableField(1063)]
		private CampaignTime _ignoredUntilTime;

		// Token: 0x04000B41 RID: 2881
		[SaveableField(1071)]
		public Vec2 AverageFleeTargetDirection;

		// Token: 0x04000B43 RID: 2883
		private bool _besiegerCampResetStarted;

		// Token: 0x04000B46 RID: 2886
		[CachedData]
		private int _locatorNodeIndex;

		// Token: 0x04000B4B RID: 2891
		[SaveableField(1120)]
		private Clan _actualClan;

		// Token: 0x04000B4C RID: 2892
		[SaveableField(1200)]
		private float _moraleDueToEvents;

		// Token: 0x04000B4D RID: 2893
		[CachedData]
		private PathFaceRecord _lastNavigationFace;

		// Token: 0x04000B4E RID: 2894
		[CachedData]
		private PathFaceRecord _currentNavigationFace;

		// Token: 0x04000B4F RID: 2895
		[CachedData]
		private Vec2 _errorPosition;

		// Token: 0x04000B50 RID: 2896
		[SaveableField(210)]
		private PartyComponent _partyComponent;

		// Token: 0x020005B0 RID: 1456
		public enum PartyObjective
		{
			// Token: 0x040017AD RID: 6061
			Neutral,
			// Token: 0x040017AE RID: 6062
			Defensive,
			// Token: 0x040017AF RID: 6063
			Aggressive,
			// Token: 0x040017B0 RID: 6064
			NumberOfPartyObjectives
		}

		// Token: 0x020005B1 RID: 1457
		internal struct CachedPartyVariables
		{
			// Token: 0x040017B1 RID: 6065
			internal bool IsAttachedArmyMember;

			// Token: 0x040017B2 RID: 6066
			internal bool IsArmyLeader;

			// Token: 0x040017B3 RID: 6067
			internal bool IsMoving;

			// Token: 0x040017B4 RID: 6068
			internal bool HasMapEvent;

			// Token: 0x040017B5 RID: 6069
			internal float NextMoveDistance;

			// Token: 0x040017B6 RID: 6070
			internal Vec2 CurrentPosition;

			// Token: 0x040017B7 RID: 6071
			internal Vec2 LastCurrentPosition;

			// Token: 0x040017B8 RID: 6072
			internal Vec2 NextPosition;

			// Token: 0x040017B9 RID: 6073
			internal Vec2 TargetPartyPositionAtFrameStart;

			// Token: 0x040017BA RID: 6074
			internal PathFaceRecord TargetPartyCurrentNavigationFaceAtFrameStart;

			// Token: 0x040017BB RID: 6075
			internal PathFaceRecord NextPathFaceRecord;
		}
	}
}
