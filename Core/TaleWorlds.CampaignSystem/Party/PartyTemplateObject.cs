using System;
using System.Collections.Generic;
using System.Xml;
using TaleWorlds.Library;
using TaleWorlds.ObjectSystem;

namespace TaleWorlds.CampaignSystem.Party
{
	public sealed class PartyTemplateObject : MBObjectBase
	{
		internal static void AutoGeneratedStaticCollectObjectsPartyTemplateObject(object o, List<object> collectedObjects)
		{
			((PartyTemplateObject)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		public override void Deserialize(MBObjectManager objectManager, XmlNode node)
		{
			this.Stacks = new MBList<PartyTemplateStack>();
			base.Deserialize(objectManager, node);
			foreach (object obj in node.ChildNodes)
			{
				XmlNode xmlNode = (XmlNode)obj;
				if (xmlNode.Name == "stacks")
				{
					foreach (object obj2 in xmlNode.ChildNodes)
					{
						XmlNode xmlNode2 = (XmlNode)obj2;
						if (xmlNode2.Name == "PartyTemplateStack")
						{
							PartyTemplateStack partyTemplateStack = new PartyTemplateStack((CharacterObject)objectManager.ReadObjectReferenceFromXml("troop", typeof(CharacterObject), xmlNode2), Convert.ToInt32(xmlNode2.Attributes["min_value"].Value), Convert.ToInt32(xmlNode2.Attributes["max_value"].Value));
							this.Stacks.Add(partyTemplateStack);
						}
					}
				}
			}
		}

		public MBList<PartyTemplateStack> Stacks;
	}
}
