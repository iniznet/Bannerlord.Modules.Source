using System;
using System.Collections.Generic;
using Helpers;
using TaleWorlds.CampaignSystem.Conversation;
using TaleWorlds.Core;
using TaleWorlds.Localization;
using TaleWorlds.ObjectSystem;
using TaleWorlds.SaveSystem;

namespace TaleWorlds.CampaignSystem.LogEntries
{
	// Token: 0x020002D3 RID: 723
	public class CharacterInsultedLogEntry : LogEntry, IEncyclopediaLog, IChatNotification
	{
		// Token: 0x06002A04 RID: 10756 RVA: 0x000B2F54 File Offset: 0x000B1154
		internal static void AutoGeneratedStaticCollectObjectsCharacterInsultedLogEntry(object o, List<object> collectedObjects)
		{
			((CharacterInsultedLogEntry)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x06002A05 RID: 10757 RVA: 0x000B2F62 File Offset: 0x000B1162
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
			collectedObjects.Add(this.Insultee);
			collectedObjects.Add(this.Insulter);
			collectedObjects.Add(this._overWhat);
		}

		// Token: 0x06002A06 RID: 10758 RVA: 0x000B2F8F File Offset: 0x000B118F
		internal static object AutoGeneratedGetMemberValueInsultee(object o)
		{
			return ((CharacterInsultedLogEntry)o).Insultee;
		}

		// Token: 0x06002A07 RID: 10759 RVA: 0x000B2F9C File Offset: 0x000B119C
		internal static object AutoGeneratedGetMemberValueInsulter(object o)
		{
			return ((CharacterInsultedLogEntry)o).Insulter;
		}

		// Token: 0x06002A08 RID: 10760 RVA: 0x000B2FA9 File Offset: 0x000B11A9
		internal static object AutoGeneratedGetMemberValue_overWhat(object o)
		{
			return ((CharacterInsultedLogEntry)o)._overWhat;
		}

		// Token: 0x06002A09 RID: 10761 RVA: 0x000B2FB6 File Offset: 0x000B11B6
		internal static object AutoGeneratedGetMemberValue_gameActionNote(object o)
		{
			return ((CharacterInsultedLogEntry)o)._gameActionNote;
		}

		// Token: 0x17000A53 RID: 2643
		// (get) Token: 0x06002A0A RID: 10762 RVA: 0x000B2FC8 File Offset: 0x000B11C8
		public override CampaignTime KeepInHistoryTime
		{
			get
			{
				return CampaignTime.Weeks(240f);
			}
		}

		// Token: 0x17000A54 RID: 2644
		// (get) Token: 0x06002A0B RID: 10763 RVA: 0x000B2FD4 File Offset: 0x000B11D4
		public override ChatNotificationType NotificationType
		{
			get
			{
				return base.CivilianNotification(this.Insulter.Clan);
			}
		}

		// Token: 0x17000A55 RID: 2645
		// (get) Token: 0x06002A0C RID: 10764 RVA: 0x000B2FE7 File Offset: 0x000B11E7
		public bool IsVisibleNotification
		{
			get
			{
				if (this._overWhat != null)
				{
					return this._overWhat.IsHero;
				}
				return this.Insultee.CharacterObject.IsHero;
			}
		}

		// Token: 0x06002A0D RID: 10765 RVA: 0x000B300D File Offset: 0x000B120D
		public CharacterInsultedLogEntry(Hero insultee, Hero insulter, CharacterObject overWhat, ActionNotes note)
		{
			this.Insultee = insultee;
			this.Insulter = insulter;
			this._overWhat = overWhat;
			this._gameActionNote = note;
		}

		// Token: 0x06002A0E RID: 10766 RVA: 0x000B3034 File Offset: 0x000B1234
		public override TextObject GetHistoricComment(Hero talkTroop)
		{
			MBTextManager.SetTextVariable("SIDE1TROOP", this.Insultee.Name, false);
			MBTextManager.SetTextVariable("SIDE2TROOP", this.Insulter.Name, false);
			if (talkTroop == this.Insultee)
			{
				return GameTexts.FindText("str_description_insultcharacter_I_insulted_y", null);
			}
			if (talkTroop == this.Insulter)
			{
				return GameTexts.FindText("str_description_insultcharacter_x_insulted_me", null);
			}
			if (talkTroop == null)
			{
				return GameTexts.FindText("str_description_insultcharacter_x_insulted_y", null);
			}
			MBTextManager.SetTextVariable("SIDE1TROOP", ConversationHelper.HeroRefersToHero(talkTroop, this.Insultee, true), false);
			MBTextManager.SetTextVariable("SIDE2TROOP", ConversationHelper.HeroRefersToHero(talkTroop, this.Insulter, false), false);
			if (this._gameActionNote == ActionNotes.CourtshipQuarrel)
			{
				Hero heroObject = this._overWhat.HeroObject;
				MBTextManager.SetTextVariable("SUBJECT", ConversationHelper.HeroRefersToHero(talkTroop, heroObject, false), false);
				return GameTexts.FindText("str_description_insultcharacter_x_insulted_y_courtship", null);
			}
			return GameTexts.FindText("str_description_insultcharacter_x_insulted_y", null);
		}

		// Token: 0x06002A0F RID: 10767 RVA: 0x000B3115 File Offset: 0x000B1315
		public override int AsReasonForEnmity(Hero referenceHero1, Hero referenceHero2)
		{
			if (referenceHero1 == this.Insultee && referenceHero2 == this.Insulter)
			{
				return 5;
			}
			if (referenceHero2 == this.Insultee && referenceHero1 == this.Insulter)
			{
				return 5;
			}
			return 0;
		}

		// Token: 0x06002A10 RID: 10768 RVA: 0x000B3140 File Offset: 0x000B1340
		public override string ToString()
		{
			return this.GetEncyclopediaText().ToString();
		}

		// Token: 0x06002A11 RID: 10769 RVA: 0x000B3150 File Offset: 0x000B1350
		public TextObject GetNotificationText()
		{
			TextObject textObject = GameTexts.FindText("str_notification_quarrel", null);
			StringHelpers.SetCharacterProperties("LORD", this.Insultee.CharacterObject, textObject, false);
			StringHelpers.SetCharacterProperties("OTHER_LORD", this.Insulter.CharacterObject, textObject, false);
			return textObject;
		}

		// Token: 0x06002A12 RID: 10770 RVA: 0x000B319A File Offset: 0x000B139A
		public bool IsVisibleInEncyclopediaPageOf<T>(T obj) where T : MBObjectBase
		{
			return obj == this.Insultee || obj == this.Insulter;
		}

		// Token: 0x06002A13 RID: 10771 RVA: 0x000B31BC File Offset: 0x000B13BC
		public TextObject GetEncyclopediaText()
		{
			TextObject textObject = TextObject.Empty;
			if (this._gameActionNote == ActionNotes.CourtshipQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_courtship", null);
			}
			if (this._gameActionNote == ActionNotes.ValorStrategyQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_setback_valor", null);
			}
			if (this._gameActionNote == ActionNotes.CalculatingStrategyQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_setback_calculating", null);
			}
			if (this._gameActionNote == ActionNotes.ResponsibilityStrategyQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_setback_responsibility", null);
			}
			if (this._gameActionNote == ActionNotes.LandCheatingQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_land", null);
			}
			if (this._gameActionNote == ActionNotes.TroublemakerQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_troublemaker", null);
			}
			if (this._gameActionNote == ActionNotes.HereticQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_heretic", null);
			}
			if (this._gameActionNote == ActionNotes.RuthlessBusinessQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_ruthless_business", null);
			}
			if (this._gameActionNote == ActionNotes.DishonestBusinessQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_dishonest_business", null);
			}
			if (this._gameActionNote == ActionNotes.ExtortingQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_extorting", null);
			}
			if (this._gameActionNote == ActionNotes.VengeanceQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_vengeance", null);
			}
			if (this._gameActionNote == ActionNotes.FiefQuarrel)
			{
				textObject = GameTexts.FindText("str_insult_news_fief", null);
			}
			if (textObject != TextObject.Empty)
			{
				StringHelpers.SetCharacterProperties("INSULTER", this.Insultee.CharacterObject, textObject, false);
				StringHelpers.SetCharacterProperties("INSULTEE", this.Insulter.CharacterObject, textObject, false);
				return textObject;
			}
			textObject = new TextObject("{=v7sfiv5m}{INSULT_NEWS} {GAME_ACTION_NOTES}", null);
			textObject.SetTextVariable("INSULT_NEWS", GameTexts.FindText("str_insult_news", null));
			textObject.SetTextVariable("GAME_ACTION_NOTES", GameTexts.FindText("str_game_action_note", this._gameActionNote.ToString()));
			return textObject;
		}

		// Token: 0x04000CB5 RID: 3253
		[SaveableField(110)]
		public readonly Hero Insultee;

		// Token: 0x04000CB6 RID: 3254
		[SaveableField(111)]
		public readonly Hero Insulter;

		// Token: 0x04000CB7 RID: 3255
		[SaveableField(112)]
		private readonly CharacterObject _overWhat;

		// Token: 0x04000CB8 RID: 3256
		[SaveableField(113)]
		private readonly ActionNotes _gameActionNote;
	}
}
