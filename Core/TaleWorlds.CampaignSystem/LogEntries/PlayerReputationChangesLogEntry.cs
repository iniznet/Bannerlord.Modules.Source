using System;
using System.Collections.Generic;
using System.Linq;
using TaleWorlds.CampaignSystem.CharacterDevelopment;
using TaleWorlds.Localization;
using TaleWorlds.SaveSystem;

namespace TaleWorlds.CampaignSystem.LogEntries
{
	// Token: 0x020002ED RID: 749
	public class PlayerReputationChangesLogEntry : LogEntry
	{
		// Token: 0x06002B53 RID: 11091 RVA: 0x000B6CFA File Offset: 0x000B4EFA
		internal static void AutoGeneratedStaticCollectObjectsPlayerReputationChangesLogEntry(object o, List<object> collectedObjects)
		{
			((PlayerReputationChangesLogEntry)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x06002B54 RID: 11092 RVA: 0x000B6D08 File Offset: 0x000B4F08
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
			collectedObjects.Add(this._trait);
			collectedObjects.Add(this._companionsInParty);
			collectedObjects.Add(this._referenceHero);
		}

		// Token: 0x06002B55 RID: 11093 RVA: 0x000B6D35 File Offset: 0x000B4F35
		internal static object AutoGeneratedGetMemberValue_trait(object o)
		{
			return ((PlayerReputationChangesLogEntry)o)._trait;
		}

		// Token: 0x06002B56 RID: 11094 RVA: 0x000B6D42 File Offset: 0x000B4F42
		internal static object AutoGeneratedGetMemberValue_companionsInParty(object o)
		{
			return ((PlayerReputationChangesLogEntry)o)._companionsInParty;
		}

		// Token: 0x06002B57 RID: 11095 RVA: 0x000B6D4F File Offset: 0x000B4F4F
		internal static object AutoGeneratedGetMemberValue_note(object o)
		{
			return ((PlayerReputationChangesLogEntry)o)._note;
		}

		// Token: 0x06002B58 RID: 11096 RVA: 0x000B6D61 File Offset: 0x000B4F61
		internal static object AutoGeneratedGetMemberValue_referenceHero(object o)
		{
			return ((PlayerReputationChangesLogEntry)o)._referenceHero;
		}

		// Token: 0x06002B59 RID: 11097 RVA: 0x000B6D6E File Offset: 0x000B4F6E
		public PlayerReputationChangesLogEntry(TraitObject trait, Hero referenceHero, ActionNotes note)
		{
			this._trait = trait;
			this._referenceHero = referenceHero;
			this._companionsInParty = Hero.MainHero.CompanionsInParty.ToList<Hero>();
			this._note = note;
		}

		// Token: 0x06002B5A RID: 11098 RVA: 0x000B6DA0 File Offset: 0x000B4FA0
		public override void GetConversationScoreAndComment(Hero talkTroop, bool findString, out string comment, out ImportanceEnum score)
		{
			score = ImportanceEnum.Zero;
			comment = "";
			if (this._companionsInParty.Contains(talkTroop))
			{
				if (talkTroop.GetTraitLevel(DefaultTraits.Honor) > 0 && this._trait == DefaultTraits.Honor)
				{
					if (this._note == ActionNotes.QuestSuccess)
					{
						MBTextManager.SetTextVariable("COMMENT_REFERENCE_HERO", this._referenceHero.Name, false);
						comment = "str_comment_companion_on_honor_for_quest_success";
						score = ImportanceEnum.SomewhatImportant;
					}
					else if (this._note == ActionNotes.QuestBetrayal)
					{
						MBTextManager.SetTextVariable("COMMENT_REFERENCE_HERO", this._referenceHero.Name, false);
						comment = "str_comment_companion_on_honor_for_quest_betrayal";
						score = ImportanceEnum.SomewhatImportant;
					}
				}
				if (talkTroop.GetTraitLevel(DefaultTraits.Generosity) > 0 && this._trait == DefaultTraits.Generosity && this._note == ActionNotes.PartyTakenCareOf)
				{
					comment = "str_comment_companion_on_generosity_for_party_morale";
					score = ImportanceEnum.SomewhatImportant;
				}
			}
		}

		// Token: 0x06002B5B RID: 11099 RVA: 0x000B6E6C File Offset: 0x000B506C
		public override string ToString()
		{
			return "PlayerReputationChangesLogEntry";
		}

		// Token: 0x04000D15 RID: 3349
		[SaveableField(410)]
		private readonly TraitObject _trait;

		// Token: 0x04000D16 RID: 3350
		[SaveableField(411)]
		private readonly List<Hero> _companionsInParty;

		// Token: 0x04000D17 RID: 3351
		[SaveableField(412)]
		private readonly ActionNotes _note;

		// Token: 0x04000D18 RID: 3352
		[SaveableField(413)]
		private readonly Hero _referenceHero;
	}
}
