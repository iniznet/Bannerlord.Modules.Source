using System;
using System.Collections.Generic;
using TaleWorlds.CampaignSystem.Actions;
using TaleWorlds.CampaignSystem.Party;
using TaleWorlds.Core;

namespace TaleWorlds.CampaignSystem.MapEvents
{
	// Token: 0x020002C3 RID: 707
	public class ForceVolunteersEventComponent : MapEventComponent
	{
		// Token: 0x0600294E RID: 10574 RVA: 0x000B0B5F File Offset: 0x000AED5F
		internal static void AutoGeneratedStaticCollectObjectsForceVolunteersEventComponent(object o, List<object> collectedObjects)
		{
			((ForceVolunteersEventComponent)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x0600294F RID: 10575 RVA: 0x000B0B6D File Offset: 0x000AED6D
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x06002950 RID: 10576 RVA: 0x000B0B76 File Offset: 0x000AED76
		protected ForceVolunteersEventComponent(MapEvent mapEvent)
			: base(mapEvent)
		{
		}

		// Token: 0x06002951 RID: 10577 RVA: 0x000B0B80 File Offset: 0x000AED80
		public static ForceVolunteersEventComponent CreateForceSuppliesEvent(PartyBase attackerParty, PartyBase defenderParty)
		{
			MapEvent mapEvent = new MapEvent();
			ForceVolunteersEventComponent forceVolunteersEventComponent = new ForceVolunteersEventComponent(mapEvent);
			mapEvent.Initialize(attackerParty, defenderParty, forceVolunteersEventComponent, MapEvent.BattleTypes.IsForcingVolunteers);
			Campaign.Current.MapEventManager.OnMapEventCreated(mapEvent);
			return forceVolunteersEventComponent;
		}

		// Token: 0x06002952 RID: 10578 RVA: 0x000B0BB5 File Offset: 0x000AEDB5
		public static ForceVolunteersEventComponent CreateComponentForOldSaves(MapEvent mapEvent)
		{
			return new ForceVolunteersEventComponent(mapEvent);
		}

		// Token: 0x06002953 RID: 10579 RVA: 0x000B0BBD File Offset: 0x000AEDBD
		protected override void OnInitialize()
		{
			ChangeVillageStateAction.ApplyBySettingToBeingForcedForVolunteers(base.MapEvent.MapEventSettlement, base.MapEvent.AttackerSide.LeaderParty.MobileParty);
		}

		// Token: 0x06002954 RID: 10580 RVA: 0x000B0BE4 File Offset: 0x000AEDE4
		protected override void OnFinalize()
		{
			CampaignEventDispatcher.Instance.ForceVolunteersCompleted((base.MapEvent.BattleState == BattleState.AttackerVictory) ? BattleSideEnum.Attacker : BattleSideEnum.Defender, this);
			ChangeVillageStateAction.ApplyBySettingToNormal(base.MapEvent.MapEventSettlement);
		}
	}
}
