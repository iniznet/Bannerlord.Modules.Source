using System;
using System.Collections.Generic;
using TaleWorlds.Localization;
using TaleWorlds.SaveSystem;

namespace TaleWorlds.CampaignSystem.Settlements
{
	// Token: 0x02000357 RID: 855
	public class Alley : SettlementArea
	{
		// Token: 0x06003059 RID: 12377 RVA: 0x000CB8D9 File Offset: 0x000C9AD9
		internal static void AutoGeneratedStaticCollectObjectsAlley(object o, List<object> collectedObjects)
		{
			((Alley)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x0600305A RID: 12378 RVA: 0x000CB8E7 File Offset: 0x000C9AE7
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
			collectedObjects.Add(this._owner);
		}

		// Token: 0x0600305B RID: 12379 RVA: 0x000CB8FC File Offset: 0x000C9AFC
		internal static object AutoGeneratedGetMemberValue_owner(object o)
		{
			return ((Alley)o)._owner;
		}

		// Token: 0x17000B8D RID: 2957
		// (get) Token: 0x0600305C RID: 12380 RVA: 0x000CB909 File Offset: 0x000C9B09
		public override Settlement Settlement
		{
			get
			{
				return this._settlement;
			}
		}

		// Token: 0x17000B8E RID: 2958
		// (get) Token: 0x0600305D RID: 12381 RVA: 0x000CB911 File Offset: 0x000C9B11
		public override TextObject Name
		{
			get
			{
				return this._name;
			}
		}

		// Token: 0x17000B8F RID: 2959
		// (get) Token: 0x0600305E RID: 12382 RVA: 0x000CB919 File Offset: 0x000C9B19
		public override Hero Owner
		{
			get
			{
				return this._owner;
			}
		}

		// Token: 0x17000B90 RID: 2960
		// (get) Token: 0x0600305F RID: 12383 RVA: 0x000CB921 File Offset: 0x000C9B21
		public override string Tag
		{
			get
			{
				return this._tag;
			}
		}

		// Token: 0x06003060 RID: 12384 RVA: 0x000CB92C File Offset: 0x000C9B2C
		public void SetOwner(Hero newOwner)
		{
			if (this._owner != null)
			{
				this._owner.OwnedAlleys.Remove(this);
			}
			Hero owner = this._owner;
			this._owner = newOwner;
			if (this._owner != null)
			{
				this._owner.OwnedAlleys.Add(this);
				this.State = ((this._owner == Hero.MainHero) ? Alley.AreaState.OccupiedByPlayer : Alley.AreaState.OccupiedByGangLeader);
			}
			else
			{
				this.State = Alley.AreaState.Empty;
			}
			CampaignEventDispatcher.Instance.OnAlleyOwnerChanged(this, newOwner, owner);
		}

		// Token: 0x17000B91 RID: 2961
		// (get) Token: 0x06003061 RID: 12385 RVA: 0x000CB9A7 File Offset: 0x000C9BA7
		// (set) Token: 0x06003062 RID: 12386 RVA: 0x000CB9AF File Offset: 0x000C9BAF
		public Alley.AreaState State { get; private set; }

		// Token: 0x06003063 RID: 12387 RVA: 0x000CB9B8 File Offset: 0x000C9BB8
		public Alley(Settlement settlement, string tag, TextObject name)
		{
			this.Initialize(settlement, tag, name);
		}

		// Token: 0x06003064 RID: 12388 RVA: 0x000CB9C9 File Offset: 0x000C9BC9
		public void Initialize(Settlement settlement, string tag, TextObject name)
		{
			this._name = name;
			this._settlement = settlement;
			this._tag = tag;
		}

		// Token: 0x06003065 RID: 12389 RVA: 0x000CB9E0 File Offset: 0x000C9BE0
		internal void AfterLoad()
		{
			if (this._owner != null)
			{
				this.State = ((this._owner == Hero.MainHero) ? Alley.AreaState.OccupiedByPlayer : Alley.AreaState.OccupiedByGangLeader);
				this._owner.OwnedAlleys.Add(this);
				return;
			}
			this.State = Alley.AreaState.Empty;
		}

		// Token: 0x04000FE7 RID: 4071
		private Settlement _settlement;

		// Token: 0x04000FE8 RID: 4072
		private TextObject _name;

		// Token: 0x04000FE9 RID: 4073
		[SaveableField(10)]
		private Hero _owner;

		// Token: 0x04000FEA RID: 4074
		private string _tag;

		// Token: 0x0200068E RID: 1678
		public enum AreaState
		{
			// Token: 0x04001B3A RID: 6970
			Empty,
			// Token: 0x04001B3B RID: 6971
			OccupiedByGangLeader,
			// Token: 0x04001B3C RID: 6972
			OccupiedByPlayer
		}
	}
}
